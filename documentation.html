<!-- This file was generated by mk_html_help.pro -->
<html>
 
<head>
<TITLE>NTI Wavelet Tools</TITLE>
</head>
 
<body>
<H1>NTI Wavelet Tools</H1>
<P>
This page was created by the IDL library routine 
<CODE>mk_html_help</CODE>.  For more information on 
this routine, refer to the IDL Online Help Navigator 
or type: <P>
<PRE>     ? mk_html_help</PRE><P>
at the IDL command line prompt.<P>
<STRONG>Last modified: </STRONG>Wed Oct 23 11:23:45 2019.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>List of Routines</H1></A>
<UL>
<LI><A HREF="#AUG_THETA_STAR_ALL">AUG_THETA_STAR_ALL</A>
<LI><A HREF="#AUG_THETA_STAR_CONV">AUG_THETA_STAR_CONV</A>
<LI><A HREF="#FFT_ERROR_PROPAGATION">FFT_ERROR_PROPAGATION</A>
<LI><A HREF="#NTI_WAVELET_BANDPOWER_CORRELATION">
NTI_WAVELET_BANDPOWER_CORRELATION</A>
<LI><A HREF="#NTI_WAVELET_BRIDGE">NTI_WAVELET_BRIDGE</A>
<LI><A HREF="#NTI_WAVELET_CLEANUP">NTI_WAVELET_CLEANUP</A>
<LI><A HREF="#NTI_WAVELET_COMMON">NTI_WAVELET_COMMON</A>
<LI><A HREF="#NTI_WAVELET_CROSSPHASE_CORRECTION">
NTI_WAVELET_CROSSPHASE_CORRECTION</A>
<LI><A HREF="#NTI_WAVELET_DEFAULT">NTI_WAVELET_DEFAULT</A>
<LI><A HREF="#NTI_WAVELET_DEFINED">NTI_WAVELET_DEFINED</A>
<LI><A HREF="#NTI_WAVELET_GRIDDATA">NTI_WAVELET_GRIDDATA</A>
<LI><A HREF="#NTI_WAVELET_GUI">NTI_WAVELET_GUI</A>
<LI><A HREF="#NTI_WAVELET_GUI_ADDMESSAGE">NTI_WAVELET_GUI_ADDMESSAGE</A>
<LI><A HREF="#NTI_WAVELET_GUI_CALCMEMORY">NTI_WAVELET_GUI_CALCMEMORY</A>
<LI><A HREF="#NTI_WAVELET_GUI_CREATE">NTI_WAVELET_GUI_CREATE</A>
<LI><A HREF="#NTI_WAVELET_GUI_EVENT">NTI_WAVELET_GUI_EVENT</A>
<LI><A HREF="#NTI_WAVELET_GUI_PAIRSELECT">NTI_WAVELET_GUI_PAIRSELECT</A>
<LI><A HREF="#NTI_WAVELET_GUI_PAIRSELECT_EVENT">NTI_WAVELET_GUI_PAIRSELECT_EVENT
</A>
<LI><A HREF="#NTI_WAVELET_GUI_READCONFIG">NTI_WAVELET_GUI_READCONFIG</A>
<LI><A HREF="#NTI_WAVELET_GUI_SAVEMAT">NTI_WAVELET_GUI_SAVEMAT</A>
<LI><A HREF="#NTI_WAVELET_GUI_SENS">NTI_WAVELET_GUI_SENS</A>
<LI><A HREF="#NTI_WAVELET_GUI_SETDEFAULTS">NTI_WAVELET_GUI_SETDEFAULTS</A>
<LI><A HREF="#NTI_WAVELET_GUI_WRITECONFIG">NTI_WAVELET_GUI_WRITECONFIG</A>
<LI><A HREF="#NTI_WAVELET_MAIN">NTI_WAVELET_MAIN</A>
<LI><A HREF="#NTI_WAVELET_MODEFILTER_FITREL_MATRIX">
NTI_WAVELET_MODEFILTER_FITREL_MATRIX</A>
<LI><A HREF="#NTI_WAVELET_PHASEDIAGRAM">NTI_WAVELET_PHASEDIAGRAM</A>
<LI><A HREF="#NTI_WAVELET_PLOT">NTI_WAVELET_PLOT</A>
<LI><A HREF="#NTI_WAVELET_PLOT_1D">NTI_WAVELET_PLOT_1D</A>
<LI><A HREF="#NTI_WAVELET_PLOT_3D">NTI_WAVELET_PLOT_3D</A>
<LI><A HREF="#NTI_WAVELET_PLOT_STFT_BICOH">NTI_WAVELET_PLOT_STFT_BICOH</A>
<LI><A HREF="#NTI_WAVELET_PRIME_FACTOR">NTI_WAVELET_PRIME_FACTOR</A>
<LI><A HREF="#NTI_WAVELET_READ_WAV">NTI_WAVELET_READ_WAV</A>
<LI><A HREF="#NTI_WAVELET_REMOVE_COLLECTORID">NTI_WAVELET_REMOVE_COLLECTORID</A>
<LI><A HREF="#NTI_WAVELET_RIDGE_FOLLOWER">NTI_WAVELET_RIDGE_FOLLOWER</A>
<LI><A HREF="#NTI_WAVELET_SIGNUM">NTI_WAVELET_SIGNUM</A>
<LI><A HREF="#NTI_WAVELET_SINC">NTI_WAVELET_SINC</A>
<LI><A HREF="#NTI_WAVELET_TIMESTAMP">NTI_WAVELET_TIMESTAMP</A>
<LI><A HREF="#PG_ANAL2">PG_ANAL2</A>
<LI><A HREF="#PG_CCORR">PG_CCORR</A>
<LI><A HREF="#PG_COLORSCALE">PG_COLORSCALE</A>
<LI><A HREF="#PG_CWT">PG_CWT</A>
<LI><A HREF="#PG_DOWNSAMPLE">PG_DOWNSAMPLE</A>
<LI><A HREF="#PG_FILENAME">PG_FILENAME</A>
<LI><A HREF="#PG_FN_GAUSSIAN">PG_FN_GAUSSIAN</A>
<LI><A HREF="#PG_FN_MORLET">PG_FN_MORLET</A>
<LI><A HREF="#PG_FN_PAUL">PG_FN_PAUL</A>
<LI><A HREF="#PG_GEN_WIN">PG_GEN_WIN</A>
<LI><A HREF="#PG_INITGRAPH">PG_INITGRAPH</A>
<LI><A HREF="#PG_LOG2">PG_LOG2</A>
<LI><A HREF="#PG_MODEFILTER_FITREL">PG_MODEFILTER_FITREL</A>
<LI><A HREF="#PG_MODEFILTER_MONOTON">PG_MODEFILTER_MONOTON</A>
<LI><A HREF="#PG_NUM2STR">PG_NUM2STR</A>
<LI><A HREF="#PG_OTV">PG_OTV</A>
<LI><A HREF="#PG_PHASEDIAGRAM">PG_PHASEDIAGRAM</A>
<LI><A HREF="#PG_PLOT4">PG_PLOT4</A>
<LI><A HREF="#PG_REMOVESTR">PG_REMOVESTR</A>
<LI><A HREF="#PG_RESAMPLE">PG_RESAMPLE</A>
<LI><A HREF="#PG_RETRIGGER">PG_RETRIGGER</A>
<LI><A HREF="#PG_SCALOGRAM_SIM2">PG_SCALOGRAM_SIM2</A>
<LI><A HREF="#PG_SPECTROGRAM_SIM">PG_SPECTROGRAM_SIM</A>
<LI><A HREF="#PG_STFT">PG_STFT</A>
<LI><A HREF="#PI_LOADNCOL">PI_LOADNCOL</A>
<LI><A HREF="#START_WEB_BROWSER">START_WEB_BROWSER</A>
<LI><A HREF="#WV_FN_COIFLET">WV_FN_COIFLET</A>
<LI><A HREF="#WV_FN_DAUBECHIES">WV_FN_DAUBECHIES</A>
<LI><A HREF="#WV_FN_HAAR">WV_FN_HAAR</A>
<LI><A HREF="#WV_FN_SYMLET">WV_FN_SYMLET</A>
</UL><P>
 
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="AUG_THETA_STAR_ALL">
<H2>AUG_THETA_STAR_ALL</H2></A>
<A HREF="#AUG_THETA_STAR_CONV">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

 NAME: aug_theta_star_all

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2016.03.11.

 PURPOSE: Load saved raw data file. Convert geometrical poloidal coordinates with respect to the magnetic axis (theta) to poloidal coordinates
    in straight filed line geometry (theta^star) in the ASDEX-Upgrade tokamak on a given q surface. Save new raw data file.
    Uses az external FORTRAN routine to be found at the AUG AFS!

 CALLING SEQUENCE:
   aug_theta_star_all, filename, q, [dianam]

 INPUTS:
   filename: file name of the rwa data file to be converted
   q: q value of the magnetic surface to do the calculation
   dianam (optional): equilibrium reconstruction to use: can be 'FPP' for Function parametrization or 'EQI' for cliste; default: 'EQI'

 OUTPUTS:
   Raw data file written to the same folder as the original file

 EXAMPLE:
   aug_theta_star_all,'AUGD_32388_Loaded-with-MTR.sav',2; 
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\aug_theta_star_all.pro)</STRONG><P>
<HR>
 
<A NAME="AUG_THETA_STAR_CONV">
<H2>AUG_THETA_STAR_CONV</H2></A>
<A HREF="#AUG_THETA_STAR_ALL">[Previous Routine]</A>
<A HREF="#FFT_ERROR_PROPAGATION">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

 NAME: aug_theta_star_conv

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2010.07.28.

 PURPOSE: Convert geometrical poloidal coordinates with respect to the magnetic axis (theta) to poloidal coordinates
    in straight filed line geometry (theta^star) in the ASDEX-Upgrade tokamak on a given q surface.
    Uses az external FORTRAN routine to be found at the AUG AFS!

 CALLING SEQUENCE:
   theta_star=aug_theta_star_conv( shot, time, q, theta, [dianam])

 INPUTS:
   shot: shot numbers
   time: time-point to serch for in s
   q: q value of the magnetic surface to do the calculation
   theta: theta geometrical poloidal angles in degree
   dianam (optional): equilibrium reconstruction to use: can be 'FPP' for Function parametrization or EQI for cliste; default: 'FPP'

 OUTPUTS:
   theta_star: Straight filed line poloidal coordinates (Returns original angles, if conversion fails!)
   time: time-point found

 EXAMPLE:
   Compare theta_star values with geometrical theta values in AUG shot at time_orig for a given q:
   time=time_orig
   theta=findgen(20)/19.*2.*!PI
   theta_star=aug_theta_star_conv(shot,time,q,theta)
   print, time_orig-time
   plot, theta, theta_star, /tight, xtitle='theta', ytitle='theta_star'

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\aug_theta_star_conv.pro)</STRONG><P>
<HR>
 
<A NAME="FFT_ERROR_PROPAGATION">
<H2>FFT_ERROR_PROPAGATION</H2></A>
<A HREF="#AUG_THETA_STAR_CONV">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_BANDPOWER_CORRELATION">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	FFT_ERROR_PROPAGATION

 PURPOSE:
	This procedure calculates the propagation of the errors in time domain to frequency domain

 CALLING SEQUENCE:
	FFT_ERROR_PROPAGATION, ...

 INPUTS:
	fourier:	The FFT of the signal (complex array)
	td_err:		The error in the time domain (function of time)
	win:		The used window for the FFT

 INPUTS:

	re_err:		The error on the real part of the fft
	im_err:		The error on the imaginary part of the fft
	abs_err:	The error on the absolute of the fft
	abs_crit:	Shows the points where the results of abs_err can be used
	abs_quad:	The second term of the Taylor series of the absolute value
	phase_err:	The error on the phase of the fft
	phase_crit:	Shows the points where the results of phase_err can be used
	phase_quad:	The second term of the Taylor series of the phase
	crit_ratio:	The usable value is where the second term of the Taylor series
			is at least crit_ratio times smaller than the first term

 EXAMPLE:
	

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\fft_error_propagation.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_BANDPOWER_CORRELATION">
<H2>NTI_WAVELET_BANDPOWER_CORRELATION</H2></A>
<A HREF="#FFT_ERROR_PROPAGATION">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_BRIDGE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: nti_wavelet_bandpower_correlation

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2018.08.09.

 PURPOSE: Calculate and save 2 bandpowers and corresponding correlation functions 
 derived from time-frequency cross-transforms at given time and frequency coordinates 
 for processed data from NTI Wavelet Tools GUI

 CALLING SEQUENCE:
 nti_wavelet_bandpower_correlation, saved_datablock, bands=bands, [tranges], [f_downsample], [ID],$
              [ccf_mean],[ccf_err],[t_c],[bp_save]

 INPUTS:
   saved_datablock: Processed data structure from NTI Wavelet Tools GUI
   bands: Band limits: [b1_lower,b1_upper,b2_lower,b2_upper]
   tranges (optional): Time ranges to calculate the CCFs for 
   f_downsample (optional): Downsampling frequency of the correlation functions; default: no downsampling
   ID (optional): ID of run; default: time stamp

 OUTPUT:
   ccf_mean (optional): mean CCF
   ccf_err (optional): standard deviation of CCF
   t_c (optional): time axis of CCF
   bp_save (optional): save bandpowers
   

 EXAMPLE:
    restore,'test_processed.sav'
    IDL> nti_wavelet_bandpower_correlation, saved_datablock, bands=[20,30,40,50]
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_bandpower_correlation.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_BRIDGE">
<H2>NTI_WAVELET_BRIDGE</H2></A>
<A HREF="#NTI_WAVELET_BANDPOWER_CORRELATION">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_CLEANUP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: nti_wavelet_bridge

 PURPOSE: The routine accepts input data as arrays, assemble the input_structure and call nti_wavelet_gui.pro.
          The call of nti_wavelet_gui.pro can be disabled, the assembled input_stucture is an optional output.
          Primary area of application is to serve as a bridge between nti_wavelet_gui.pro and routines outside IDL.

 INPUTS:
   expname:        Name of the experiment. [string]
   shotnumber:     Shotnumber. [long integer]
   channels:       Name of the different signals. [string array]
   datas:      Array containing all signals. [floating point array]
   time:         Vector containing the time axis. [floating point vector]
   theta:          Theta coordinates. [floating point vector]
   phi:            Phi coordinates. [floating point vector]
   data_history:   Short description of data. [string]
   coord_history:  Short description of coordinates. [string]
   file_name(optional): File name to save input structure to
   nocall (optional): Switch to disable call of nti_wavelet_gui.pro  [boolean]

 OUTPUT:
   input_structure (optional): input_structure of nti_wavelet_gui
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_bridge.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_CLEANUP">
<H2>NTI_WAVELET_CLEANUP</H2></A>
<A HREF="#NTI_WAVELET_BRIDGE">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_COMMON">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
 NTI_WAVELET_CLEANUP

 PURPOSE:
 This procedure stores the system variables in the IDL environment and restores them upon request.
 It creates a tepmorary_variable_storage.sav file for that purpose that is deleted after restoring.

 CALLING SEQUENCE:
 nti_wavelet_cleanup [,/store]

 INPUTS:
 /store (optional): Stores the variables instead of restoring

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_cleanup.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_COMMON">
<H2>NTI_WAVELET_COMMON</H2></A>
<A HREF="#NTI_WAVELET_CLEANUP">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_CROSSPHASE_CORRECTION">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_COMMON

 PURPOSE:
	This is the common block of NTI Wavelet Tools Graphical User Interface routines.

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_common.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_CROSSPHASE_CORRECTION">
<H2>NTI_WAVELET_CROSSPHASE_CORRECTION</H2></A>
<A HREF="#NTI_WAVELET_COMMON">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_DEFAULT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
 NTI_WAVELET_CROSSPHASE_CORRECTION

 PURPOSE:
 This procedure correct cross-phases of cross-transforms if
 the correc factors are available in fil.

 INPUT:
   expname:  The name of the experiment which from the signals are coming.
   startpath:  The path where the correction factors are stored.
   timeax: The time axis.
   freqax: The frequency axis.
   crosstransforms:  Cross-transforms to be modified  (same as OUTPUT)
   channel_pairs:  String array containing the avialable channel pairs.
   ind_channel_pairs:  Indices of selected channel pairs.
   channelpairs_used: String array containing the used channel pairs.
   check_correction_indicator:  Set to 1 to check availability of correction factors.
   calculate_correction:  Set to 1 to perform correction.

 OUTPUT:
   correction_indicator: Indicate whether the correction factors are avaialbe or not.
   non_existing_chpairs: Return the name of channel pairs for which the 
     correction factors are not available.
   crosstransforms: The modified crosstransforms (same as INPUT)

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_crossphase_correction.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_DEFAULT">
<H2>NTI_WAVELET_DEFAULT</H2></A>
<A HREF="#NTI_WAVELET_CROSSPHASE_CORRECTION">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_DEFINED">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

NAME: nti_wavelet_default

 Written by: Sandor Zoletnik

 PURPOSE: Set default value for variable, if it is not defined. 
    If keyword /nullarray is set, it also sets default value for a variable equaling 0.

 Calling sequence:
   nti_wavelet_default,var,value,[nullarray]

 Inputs:
   var: variable name to be examined
   val: default value to be set
   /nullarray (optianal): switch to set default value also for a variable equaling 0

 Output:
   var: returns default value or original value 

 Example:
  nti_wavelet_default,x,0
  print,x
  nti_wavelet_default,x,1
  print,x
  nti_wavelet_default,x,1,/nullarray
  print, x

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_default.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_DEFINED">
<H2>NTI_WAVELET_DEFINED</H2></A>
<A HREF="#NTI_WAVELET_DEFAULT">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GRIDDATA">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

NAME: nti_wavelet_defined

 Written by: Sandor Zoletnik

 PURPOSE: Return 1, if variable exists, otherwise 0. 
    If keyword /nullarray is set, it also returns 0 for a variable equaling 0.

 Calling sequence:
   vareixsts=nti_wavelet_defined(var,[nullarray])

 Inputs:
   var: variable name to be examined
   /nullarray (optianal): switch to return 0 also for a variable equaling 0

 Output:
   return value: 0 or 1 

 Example:
  print, nti_wavelet_defined(x)
  x=0
  print, nti_wavelet_defined(x)
  print, nti_wavelet_defined(x,/nullarray)
  x=0
  print, nti_wavelet_defined(x,/nullarray)

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_defined.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GRIDDATA">
<H2>NTI_WAVELET_GRIDDATA</H2></A>
<A HREF="#NTI_WAVELET_DEFINED">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

 NAME:
	NTI_WAVELET_GRIDDATA

 PURPOSE:
	This function interpolates irregulary grided data values to a regular grid using
	nearest neighbor interpolation method. The function can be used when
	x axis is regular and y axis is irregular. Y axis must be monoton.
	The start and the end point of the regular and irrgular y axes will be the same.

 CALLING SEQUENCE:
	NTI_WAVELET_GRIDDATA, matrix, xaxis, yaxis, resolution

 INPUTS:
	matrix: 2D matrix to be interpolated
	xaxis: Regular x axis of the matrix
	yaxis: Irregular y axis of the matrix
	resolution: The number of datapints in the new, regular y axis

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_griddata.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI">
<H2>NTI_WAVELET_GUI</H2></A>
<A HREF="#NTI_WAVELET_GRIDDATA">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_ADDMESSAGE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI

 PURPOSE:
	This procedure is the main program of NTI Wavelet Tools Graphical User Interface,
	which handles the wavelet based data processing routines. The data to be
	processed can loaded from .sav files, but the construction ot this procedure
	makes it easy to call this program from other routines, which can provide the data.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_ADDMESSAGE">
<H2>NTI_WAVELET_GUI_ADDMESSAGE</H2></A>
<A HREF="#NTI_WAVELET_GUI">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_CALCMEMORY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_ADDMESSAGE

 PURPOSE:
	This procedure extends the existing statustext and prints to text box
	of NTI Wavelet Tools Graphical User Interface.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_ADDMESSAGE, addtext = addtext

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 INPUTS:
	addtext:	This is the text to be printed out to text box.

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

 EXAMPLE:
	NTI_WAVELET_GUI_ADDMESSAGE, addtext = 'Write here your messages!'

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_addmessage.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_CALCMEMORY">
<H2>NTI_WAVELET_GUI_CALCMEMORY</H2></A>
<A HREF="#NTI_WAVELET_GUI_ADDMESSAGE">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_CREATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_CALCMEMORY

 PURPOSE:
	This procedure predicts the memory to be used for the calculations,
	and prints out to NTI Wavelet Tools Graphical User Interface.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_CALCMEMORY

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_calcmemory.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_CREATE">
<H2>NTI_WAVELET_GUI_CREATE</H2></A>
<A HREF="#NTI_WAVELET_GUI_CALCMEMORY">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_EVENT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_CREATE

 PURPOSE:
	This procedure creates widgets of NTI Wavelet Tools Graphical User Interface.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_CREATE

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_create.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_EVENT">
<H2>NTI_WAVELET_GUI_EVENT</H2></A>
<A HREF="#NTI_WAVELET_GUI_CREATE">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_PAIRSELECT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_EVENT

 PURPOSE:
	This procedure is the event handler of NTI Wavelet Tools Graphical User Interface
	main widget (nti_wavelet_gui_widg).

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_EVENT

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_event.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_PAIRSELECT">
<H2>NTI_WAVELET_GUI_PAIRSELECT</H2></A>
<A HREF="#NTI_WAVELET_GUI_EVENT">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_PAIRSELECT_EVENT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_PAIRSELECT

 PURPOSE:
	This procedure handles the channel pair selection in NTI Wavelet Tools Graphical User Interface,
	and creates the widget of this.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_PAIRSELECT

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_pairselect.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_PAIRSELECT_EVENT">
<H2>NTI_WAVELET_GUI_PAIRSELECT_EVENT</H2></A>
<A HREF="#NTI_WAVELET_GUI_PAIRSELECT">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_READCONFIG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_PAIRSELECT_EVENT

 PURPOSE:
	This procedure is the event handler of the channel pair selection
	widget (nti_wavelet_gui_pairselect_base_widg) in NTI Wavelet
	Tools Graphical User Interface.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_EVENT

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_pairselect_event.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_READCONFIG">
<H2>NTI_WAVELET_GUI_READCONFIG</H2></A>
<A HREF="#NTI_WAVELET_GUI_PAIRSELECT_EVENT">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_SAVEMAT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_READCONFIG

 PURPOSE:
	This procedure reads all off the setups of NTI Wavelet Tools
	Graphical User Interface's main widget.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_READCONFIG, (/processing, /visualization)

		This procedure works only if at least one keyword is set.

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 INPUTS:
	/processing:	Reads all off the setups of Processing block.
	/visualization:	Reads all off the setups of Visualization block.

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

 EXAMPLE:
	NTI_WAVELET_GUI_READCONFIG, /processing, /visualization

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_readconfig.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_SAVEMAT">
<H2>NTI_WAVELET_GUI_SAVEMAT</H2></A>
<A HREF="#NTI_WAVELET_GUI_READCONFIG">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_SENS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
 NTI_WAVELET_GUI_SAVEMAT

 PURPOSE:
 This procedure is save the raw data from the GUI
 to a Matlba binary file (.mat).

   THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
   DO NOT CALL THIS ROUTINE ALONE!


 CALLING SEQUENCE:
 NTI_WAVELET_GUI_SAVEMAT, $
   [,filename] [,expname] [,shotnumber] $
   [,channels] [,data_data] [,timeax] $
   [,theta] [,phi] $
   [,data_history] [,coord_history]

 INPUTS:
   filename:       The filename of the .mat file to be saved.
 Variables to be saves to the .mat file:
   expname:        Name of the experiment. [string]
   shotnumber:     Shotnumber. [long integer]
   channels:       Name of the different signals. [string array]
   data_data:      Array containing all signals. [floating point array]
   timeax:         Vector containing the time axis. [floating point vector]
   theta:          Theta coordinates. [floating point vector]
   phi:            Phi coordinates. [floating point vector]
   data_history:   Short description of data. [string]
   coord_history:  Short description of coordinates. [string]

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_savemat.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_SENS">
<H2>NTI_WAVELET_GUI_SENS</H2></A>
<A HREF="#NTI_WAVELET_GUI_SAVEMAT">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_SETDEFAULTS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_SENS

 PURPOSE:
	This procedure handles the sensitivity of NTI Wavelet Tools
	Graphical User Interface's main widget.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_SENS, (/processing, /visualization)

		This procedure works only if at least one keyword is set.

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 INPUTS:
	/processing:	Sets sensitivity on Processing block.
	/visualization:	Sets sensitivity on Visualization block.
	/datapoints:	Calculate and plot the number of data points after changing the frequency range panel.
	/set_minimum_frequency: Calculate and set in the GUI the actual value of minimum frequency of wavelet transforms
	/calc_minimum_frequency: Only calculate the actual value of minimum frequency of wavelet transforms
				and return it in minimum_frequency variable
 /cross_phase_correction: Check the possibility of cross-phase correction and handle sensitivity if required

 OUTPUTS:
	/minimum_frequency: the actual value of minimum frequency of wavelet transforms
			calculated only if /set_minimum_frequency or /calc_minimum_frequency is used

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

 EXAMPLE:
	NTI_WAVELET_GUI_SENS, /processing, /visualization

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_sens.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_SETDEFAULTS">
<H2>NTI_WAVELET_GUI_SETDEFAULTS</H2></A>
<A HREF="#NTI_WAVELET_GUI_SENS">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_GUI_WRITECONFIG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_SETDEFAULTS

 PURPOSE:
	This program sets defaults of NTI Wavelet Tools
	Graphical User Interface at startup.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_SETDEFAULTS, (/processing, /visualization, $
		/proc_transforms, /proc_crosstransforms,  /proc_coherences, $
		/proc_modenumbers)

		This procedure works only if at least one keyword is set.

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 INPUTS:
	/processing:	Sets all off the defaults of Processing block.
	/visualization:	Sets all off the defaults of Visualization block.
	/proc_transforms:	Sets only the defaults of Transforms block.
	/proc_crosstransforms:	Sets only the defaults of Cross-transforms block.
	/proc_coherences:	Sets only the defaults of Coherences block.
	/proc_modenumbers:	Sets only the defaults of Modenumbers block.

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

 EXAMPLE:
	NTI_WAVELET_GUI_SETDEFAULTS, /processing, /visualization

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_setdefaults.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_GUI_WRITECONFIG">
<H2>NTI_WAVELET_GUI_WRITECONFIG</H2></A>
<A HREF="#NTI_WAVELET_GUI_SETDEFAULTS">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_MAIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_GUI_WRITECONFIG

 PURPOSE:
	This procedure writes the saved setups of NTI Wavelet Tools
	Graphical User Interface's to the main widget.

 CALLING SEQUENCE:
	NTI_WAVELET_GUI_WRITECONFIG, (/processing, /visualization, $
		/proc_transforms, /proc_crosstransforms,  /proc_coherences, $
		/proc_modenumbers)

		This procedure works only if at least one keyword is set.

		THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
		DO NOT CALL THIS ROUTINE ALONE!

 INPUTS:
	/processing:	Writes all off the setups of Processing block.
	/visualization:	Writes all off the setups of Visualization block.
	/proc_transforms:	Writes only the setups of Transforms block.
	/proc_crosstransforms:	Writes only the setups of Cross-transforms block.
	/proc_coherences:	Writes only the setups of Coherences block.
	/proc_modenumbers:	Writes only the setups of Modenumbers block.

 COMMON BLOCKS:
	NTI_WAVELET_GUI_COMMON:	It contains widget ids and structures of datas.

 EXAMPLE:
	NTI_WAVELET_GUI_WRITECONFIG, /processing, /visualization

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_gui_writeconfig.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_MAIN">
<H2>NTI_WAVELET_MAIN</H2></A>
<A HREF="#NTI_WAVELET_GUI_WRITECONFIG">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_MODEFILTER_FITREL_MATRIX">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

NAME: nti_wavelet_main

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2011.07.25.

 PURPOSE: Calculate scalograms (or spectrograms), cross/transforms, coherences and mode numbers
       on the time-frequency plane.

 CALLING SEQUENCE (optional variables marked by []): 
    nti_wavelet_main, data [,errdata] [,error] [,dtimeax] [,chpos] [,expname] [,shotnumber] [,timerange] $
      [,channels] [,channelpairs_used] [,transf_selection] $
      [,cwt_selection] [,cwt_family] [,cwt_order] [,cwt_dscale] $
      [,stft_selection] [,stft_details] [,stft_window] [,stft_length] [,stft_fres] [,stft_step] $
      [,freq_min] [,freq_max] $
      [,crosstr_selection] [,coh_selection] [,coh_avr] [,transfer_selection]$
      [,mode_selection] [,mode_type] [,mode_filter] $
      [,mode_steps] [,mode_min [,mode_max] [,mode_optimized] [,startpath] $
      [,timeaxg [,freqax] [,scaleax] [,transforms] [,smoothed_apsds] $
      [,crosstransforms] [,smoothed_crosstransforms] $
      [,coherences] [,transfers] [,modenumbers] [,qs] [,chi2]$
      [,abs_errs] [,phase_errs] [,bicoh_selection] [,bispectrums] [,bicoherences]

 INPUTS:
    data: data vectors, Float[number of data points, number of channels]
    errdata: error on the data vectors, Float[number of data points, number of channels]
    error: selecting to calculate error on STFT, Int; default: 0
    dtimeax: time axis of data vectors in s, Double[number of data points]
    chpos: for 1D mode number determination (IDL): channel positions in radian, Double[number of channels]
           for 2D mode number determination (Python): [phi,theta] channel positions in radian, Double[2,number of channels]
    expname: name of the experiment, String (for example: SXR, MHA); default: 'General'
    shotnumber: shot number, Long; default: 0
    timerange: timerange to view in s, Double[2]; default: the start and the end of the time axis
    channels: channel names, String[number of channels]; default: integer indexes
    channelpairs_used: the used channel pairs, String[2,number of selected channel pairs]; default: all possible pairs
    transf_selection: selecting to calculate transforms, Int; default: 1
    cwt_selection: selecting CWT as transformation, Int; default: 1
    cwt_family: wavelet family, String; default: 'Morlet'
    cwt_order: order of wavelet, Long; range: 3 - 24; default: 6 
    cwt_dscale: fraction of diadic scaling, Double, default: 0.1
    stft_selection: selecting STFT as transformation. Presently unused, not(cwt_selection) is used.
    stft_details: if set, detailed_transforms and detailed_crosstransforms are calculated
    stft_window: window type, String; default: 'Gauss'
    stft_length: the length of the window in number os data points, Double; default: 50
    stft_fres: number of frequency samlpes of STFT in number of frequency points, Long; default: 1000
    stft_step: length of time steps of STFT in number of data points, Long; default: 1
    freq_min: minimum frequency in kHz, Double; default for STFT: 0, for CWT: the possibly smallest frequency
    freq_max: maximum frequency in kHz, Double; default: the half of the sampling rate (Nyquist-frequency)
    prime_limit: in case of non exact time axis, the biggest prime number in the factorization of the datalength
    exact_limit: the smallest number of datapoints, where non-exact time axis can be used
    crosstr_selection: selecting to calculate cross-transforms, Int; default: 1
    coh_selection: selecting to calculate coherences, Int; default: 1 
    coh_avr: number of averages, Long; default: 5
    transfer_selection: selecting to calculate transfer functions, Int; default: 1 
    mode_selection: selecting to calculate mode numbers, Int; default: 1 
    mode_type: type of the mode number, Srting; default: 'Toroidal'
    mode_filter: type of the mode filter, String; default: 'Rel. pos.'
    mode_steps: steps between the calculated mode numbers, Double/Int; default: 1
    mode_min: minimum mode number, Double/Int; default: -6
    mode_max: maximum mode number, Double/Int; default: 6
    mode_optimized: calculate mode numbers with matrix products (high memory consumption!)
    startpath: start path, String; default: current directory

    bicoh_selection: selecting to calculate (STFT) bicoherence, Int; default: 0
    bicoh_avr: number of averages of bicoherence, Long; default: coh_avr

 OUTPUTS:
    timeax: time axis of transforms in s, Float[number of points in the time axis of the transform]
    freqax: frequency axis in kHz, Float[number of points in the frequency axis of the transform]
    scaleax: scale axis (for CWT), Float[number of points in the frequency axis of the transform]
    transforms: the transformated values, 
      Complex[number of channels, number of points in the time axis of the transform,number of points in the frequency axis of the transform]
    smooth_apsds: the smoothed APSD (auto power density),
      Float[number of channels, number of points in the time axis of the transform,number of points in the frequency axis of the transform]
    crosstransforms: the cross-transform values,
      Complex[number of selected channel pairs, number of points in the time axis of the transform,number of points in the frequency axis of the transform]
    smoothed_cosstransforms: the smoothed cross-transform values,
      Complex[number of selected channel pairs, number of points in the time axis of the transform,number of points in the frequency axis of the transform]
    coherences: the calculated coherences
      Float[number of selected channel pairs, number of points in the time axis of the transform,number of points in the frequency axis of the transform]
    transfers: the calculated transfer functions
      Complex[2,number of selected channel pairs, number of points in the time axis of the transform,number of points in the frequency axis of the transform]
    modenumbers: the calculated mode numbers
      Float[number of points in the time axis of the transform,number of points in the frequency axis of the transform]
    qs: the calculated q fitting parameter values
      Float[number of points in the time axis of the transform,number of points in the frequency axis of the transform]
    chi2: the calculated chi2 values for most fitting mode at each time-frequency point
      Float[number of points in the time axis of the transform,number of points in the frequency axis of the transform]
    detailed_transforms: structure containing data calculated from STFT transforms and their errors (if set)
	detailed_transforms.abs.value: absolute value of the STFT
	detailed_transforms.abs.error: error on the absolute value of the STFT
	detailed_transforms.phase.value: phase of the STFT
	detailed_transforms.phase.error: error on the phase of the STFT
	detailed_transforms.ed.value: energy density caluclated from STFT
	detailed_transforms.ed.error: error on the energy density
    detailed_crosstransforms: structure containing data calculated from STFT cross-transforms and their errors (if set)
	detailed_crosstransforms.abs.value: absolute value of the crosstransforms
	detailed_crosstransforms.abs.error: error on the absolute value of the crosstransforms
	detailed_crosstransforms.phase.value: phase of the crosstransforms
	detailed_crosstransforms.phase.error: error on the phase of the crosstransforms

    bispectrums: the values of (STFT) bispectrum
    bicoherences: the values of (STFT) bicoherence

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_main.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_MODEFILTER_FITREL_MATRIX">
<H2>NTI_WAVELET_MODEFILTER_FITREL_MATRIX</H2></A>
<A HREF="#NTI_WAVELET_MAIN">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_PHASEDIAGRAM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: nti_wavelet_modefilter_fitrel_matrix

 PURPOSE: Select most fitting linear to the relative phases as a function of their relative position
       The calculation is performed on the whole time-frequency plans by matrix products
				(Can be used for a set of probes limited to a segment of the cross section)

 CALLING SEQUENCE:
	modenum=nti_wavelet_modefilter_fitrel_matrix(cphases, chpos [,weights] [,moderange] [,modestep] $
		[,qs=qs][,chi2=chi2])

 INPUTS:
		cphases: relative cross-phases in radians
		chpos: channel positions in radians 
    If chpos is a 1D vector, a combination of all probes is implied, while a 2D chpos matrix implies 
      pre/selected channel pairs. 
		weights (optional): weights of the fit; default: ones; For chi2 probe 1/sigma^2 is to be given.
		moderange (optional): vector of minimum and maximum modenumbers to be considered
			default:[-channelssize,channelssize]
		modestep (optional): modenumber steps to be considered; default: 1

 OUTPUT:
		modenum: modenumber
		qs (optional): Q_m values
   chi2 (optional): chi2 values
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_modefilter_fitrel_matrix.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_PHASEDIAGRAM">
<H2>NTI_WAVELET_PHASEDIAGRAM</H2></A>
<A HREF="#NTI_WAVELET_MODEFILTER_FITREL_MATRIX">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_PLOT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: nti_wavelet_phasediagram

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2018.07.30.

 PURPOSE: Plot phasediagrams derived from time-frequency cross-transforms at given time and frequency coordinates 
 for processed data from NTI Wavelet Tools GUI

 CALLING SEQUENCE:
 pg_phasediagram, cphases, chpos, timeax, freqax, time, freq [,shot] [,channels] [,filters] [,/print]$
    [,filterparam1] [,filterparam2] [,cpows=cpows] [,cohs=cohs] [,cphaserr=cphaserr]

 INPUTS:
   saved_datablock: Processed data structure from NTI Wavelet Tools GUI
   time: Time of phase diagram
   frequency: Frequency of phase diagram
   mode_direction (optional): 'toroidal' (default) or 'poloidal'
   filters (optional): As described in pg_phasediagram.pro (Only filters with no weighting are available!)
   filterparam1 (optional): As described in pg_phasediagram.pro
   filterparam2 (optional): As described in pg_phasediagram.pro
   /print (optional): Print to file instead of plotting

 OUTPUT: As described in pg_phasediagram.pro

 EXAMPLE:
    restore,'test_processed.sav'
    nti_wavelet_phasediagram, saved_datablock, 3.3225, 6, filters=[1,8], filterparam2=[-6,6], /print
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_phasediagram.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_PLOT">
<H2>NTI_WAVELET_PLOT</H2></A>
<A HREF="#NTI_WAVELET_PHASEDIAGRAM">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_PLOT_1D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

NAME: nti_wavelet_plot

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2011.07.25.

 PURPOSE: Plot scalograms (or spectrograms), cross/transforms, coherences and mode numbers
       on the time-frequency plane, as calculated by nti_wavelet_main.pro.

 CALLING SEQUENCE: 
    nti_wavelet_plot, timeax, freqax, scaleax, transforms, smoothed_apsds,$
    crosstransforms, smoothed_crosstransforms, coherences, transfers, modenumbers, qs $
    [,expname] [,shotnumber] [,channels] [, channelpairs_used] $
    [,cwt_selection] [,cwt_family] [,cwt_order] [,cwt_dscale] $
    [,stft_selection] [,stft_window] [,stft_length] [,stft_fres] $
    [,stft_step] [,freq_min] [,freq_max] [,coh_avr] $
    [,mode_type] [,mode_filter] $
    [,mode_steps] [,mode_min] [,mode_max] $
    [,transf_selection] [,transf_smooth] [,transf_energy] $
    [,transf_phase] [,transf_cscale] $
    [,crosstr_selection] [,crosstr_smooth] [,crosstr_energy] $
    [,crosstr_phase] [,crosstr_cscale] $
    [,coh_selection] [,coh_all] [,coh_avg] [,coh_min] $
    [,transfer_selection] [,transfer_selection] [,transfer_cohlimit] [,transfer_powlimit] [,transfer_cscale]$
    [,mode_selection] [,mode_cohlimit] [,mode_powlimit] $
    [,mode_qlimit] [,linear_freqax] [,poster] $
    [,startpath] [,savepath] [,version]


 INPUTS:
    timeax: time axis
    freqax: frequency axis
    scaleax: scale axis (for CWT)
    transforms: the transformated values
    smooth_apsds: the smoothed APSD (auto power density)
    crosstransforms: the cross-transform values
    smoothed_cosstransforms: the smoothed cross-transform values
    coherences: the calculated coherences
    transfers: the calculated transfer functions
    modenumbers: the calculated mode numbers
    qs: the calculated q fitting parameter values
    ridges: plot ridge (1D vector) on STFT spectrograms
  Processing parameters:
    expname: name of the experiment (for example: SXR, MHA)
    shotnumber: shot number
    data_history: Data history string; default: 'Not available'
    coord_history: Coordinate history string; default: 'Not available'
    timerange: timerange to view in s, 2 element vector; default: the start and the end of the time axis
    channels: channel names
    channelpairs_used: the used channel pairs
    transf_selection: selecting to calculate transforms 
    cwt_selection: selecting CWT as transformation
    cwt_family: wavelet family
    cwt_order: order of wavelet
    cwt_dscale: fraction of diadic scaling
    stft_selection: selecting STFT as transformation
    stft_window: window type
    stft_length: the length of the window
    stft_fres: the frequency resolution of STFT
    stft_step: length of time steps of STFT
    freq_min: Minimum frequency will be plotted
    freq_max: Maximum frequency will be plotted
    crosstr_selection: selecting to calculate cross-transforms 
    coh_selection: selecting to calculate coherences 
    coh_avr: number of averages
    transfer_selection: selecting to calculate transfer functions
    mode_selection: selecting to calculate mode numbers 
    mode_type: type of the mode number
    mode_filter: type of the mode filter
    mode_steps: steps between the calculated mode numbers OR margin for monotonization
    mode_min: the minimum mode number
    mode_max: the maximum mode number
  Visualisation parameters:
    transf_selection: boolean, if 1, plots transformed values
    transf_smooth: if 1, plots smoothed transform values
    transf_energy: if 1, plots the energy-density distribution
    transf_phase: if 1, plots the phase
    transf_cscale: color scale for transform-plots; default: 0.4
    crosstr_selection: if 1, plots cross-transformes
    crosstr_smooth: if 1, plots smoothed cross-transforms
    crosstr_energy: if 1, plots CPSD
    crosstr_phase: if 1, plots cross-phase
    crosstr_cscale: color scale for cross-transform plots; default: 0.4
    coh_selection: if 1, plots coherences
    coh_all: if 1, plots all coherence between the channel pairs
    coh_avg: if 1, plots the average coherence of the channel pairs
    coh_min: if 1, plots the minimum coherence of the channel pairs
    transfer_selection: if 1, plots transfer functions
    transfer_cohlimit: transfer functions will be plotted where the coherence is above this value; default: 0.
    transfer_powlimit: transfer functions will be plotted where the energy density is above this value; default: 0.
    transfer_cscale: color scale for transfer functions plots; default: 0.4
    mode_selection: if 1, plots mode numbers
    mode_cohlimit:  mode numbers will be plotted where the coherence is above this value; default: 0.
    mode_powlimit: mode numbers will be plotted where the energy density is above this value; default: 0.
    mode_qlimit: mode numbers will be plotted where the q fitting parameter is above this value; default: 100.
    linear_freqax: if 1, all plots are made with linear frequency axis
    poster: plots will be suitable for direct publication
  Paths
    startpath: start path; default: current directory
    savepath: save path; default: current directory
    version: version number; default: 'Unidentified version'

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_plot.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_PLOT_1D">
<H2>NTI_WAVELET_PLOT_1D</H2></A>
<A HREF="#NTI_WAVELET_PLOT">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_PLOT_3D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
 NTI_WAVELET_PLOT_1D

 PURPOSE:
 This procedure is plotting one dimensional data into file.

 CALLING SEQUENCE:
 NTI_WAVELET_PLOT_1D, xaxis, data, $
   [,error] $
   [,xdouble] [,ydouble], [,edouble] $
   [,xrange] [,yrange] $
   [,title] [,xtitle] [,ytitle] $
   [,psym] [,xtickname] $
   [,name] [,info] [,legend] [,path]

 INPUTS:
 xaxis:    x axis of plotted data.
 data:     Input data array. The dimensions of the data array must be [i, j] where
           i is the number of data vectors and j equals to the length of xaxis.
           The routine automatically plot all data vectors in different colors.
 error (optional):     error has the same dimensions as data and values are plotted
                       on graph as error bars.
 errstyle (optional):  if errstyle equals to 1 the errorbar is plotted with 
                       dashed line. (only if xdouble is not defined)
 xdouble (optional):   xdouble is the x axis of an additional data array. These
                       curves plotted on the graph in the same color as data, but
                       with dashed lines.
 ydouble (optional):   ydouble is the array of the additional data. These curves
                       plotted on the graph in the same color as data, but with
                       dashed lines.
 edouble(optional):    edouble constains the error of the additional data which is
                       plotted on graph as error bars. These curves plotted on the
                       graph in the same color as data, but with dashed lines.
 xrange(optional):     Range of x axis. The behaviour and the default value is the
                       same as in the IDL built-in PLOT function.
 yrange (optional):    Range of y axis. The behaviour and the default value is the
                       same as in the IDL built-in PLOT function.
 title (optional):     Title of the plot. The behaviour and the default value is
                       the same as in the IDL built-in PLOT function.
 xtitle (optional):    Title of x axis. The behaviour and the default value is the
                       same as in the IDL built-in PLOT function.
 ytitle (optional):    Title of y axis. The behaviour and the default value is the
                       same as in the IDL built-in PLOT function.
 psym (optional):      The symbol used to mark each data point. The behaviour and
                       the default value is the same as in the IDL built-in
                       PLOT function.
 xtickname (optional): A string array of up to 30 elements that controls the
                       annotation of each tick mark. The behaviour is the same
                       as in the IDL built-in PLOT function.
 name (optional):      The filename of the output.
 info (optional):      A string which is printed out next to the graph.
 legend (optional):    It places a legend on the graph. The type of this parameter
                       must be a string array which contains short description of
                       each data vector.
 path (optional):      Path can be given where output files will be saved
                       (default: ./save_data)

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_plot_1d.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_PLOT_3D">
<H2>NTI_WAVELET_PLOT_3D</H2></A>
<A HREF="#NTI_WAVELET_PLOT_1D">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_PLOT_STFT_BICOH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME: nti_wavelet_plot_3d

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2015.06.03.

 PURPOSE: Visualize non-negative 3D data fields, the matrix dimensions being plotted as x and y axis and color hue. 
 At each grid point the "strongest" data (with highest matrix value) is displayed with the appropriate (inverse) color lightness.
 One example is a set of mode numbers on the time-frequency plane with the confidence value also plotted.

 CALLING SEQUENCE:
	nti_wavelet_plot_3d, matrix [,xrange] [,yrange] [,y2range] [,wrange] [,zrange] [,data] [,xtitle] [,ytitle] $
		[,y2title] [,title] [,cscale_hue_title] [,cscale_lightness_title] [,/ylog] [,/poster]

 INPUTS:
	matrix: vector of 2D matrixes to be visualized
 field_titles (optional): Titles of the data fields
	xrange (optional): Range of x axis; default: matrix x-dimension
	yrange (optional): Range of y axis; default: matrix y-dimension
	y2range (optional): Range of 2nd y axis; default: no 2nd axis
 wrange (optional): Range of color hue axis; default: matrix w-dimension
	zrange (optional): Range of color lightness axis; default: matrix value range
	data (optional): Extra data to be written on graph
	ridge (optional): Plot ridge (1D vector) on graph
	xtitle (optional): Title of x axis
	ytitle (optional): Title of y axis
	y2title (optional): Title of 2nd y axis
	title (optional): Title of the plot
 cscale_hue_title: (optional): Axis-title of the hue axis of colorscale
 cscale_lightness_title: (optional): Axis-title of the lightness axis of colorscale
 /ylog (optional): Logarithmic 1st y axis
	/poster (optional): Print in poster form

 OUTPUT: -

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_plot_3d.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_PLOT_STFT_BICOH">
<H2>NTI_WAVELET_PLOT_STFT_BICOH</H2></A>
<A HREF="#NTI_WAVELET_PLOT_3D">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_PRIME_FACTOR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
  NTI_WAVELET_PLOT_STFT_BICOH

 PURPOSE:
  This program plots the loaded STFT bicoherence data: 
  2D frequency1-frequency2 plots for given time points
  and time-frequency2 plots for given frequency1 values.

 CALLING SEQUENCE:
   NTI_WAVELET_PLOT_STFT_BICOH, [,bicoherences] [,timeax] $
   [,times] [,freqs] $
   [,expname] [,shotnumber] [,channels] $
   [,stft_window] [,stft_length] [,stft_fres] [,stft_step] $
   [,bicoh_avr] [,opt=opt]

 INPUTS:
   bicoherences:   This array contains the STFT bicoherence matrices given by
                   nti_wavelet_main.pro.
   timeax:         The time axis of the STFT bicoherences given by
                   nti_wavelet_main.pro.
   freqax:         The frequency axis of the STFT bicoherences given by
                   nti_wavelet_main.pro.
   times:          Array containing the time points where 2D frequency1-frequency2
                   bicoherence plots will be created.
   freqs:          Array containing the frequency1 values for time-frequency2 
                   bicoherence plots.
   expname:        Name of the experiment from which the signals originate.
   shotnumber:     Number of the shot from which the signals originate.
   channels:       Name of the channels.
   stft_window:    The type of the window used to calculate STFT.
                   (given by nti_wavelet_main.pro)
   stft_length:    The length of the window used to calculate STFT.
                   (given by nti_wavelet_main.pro)
   stft_fres:      The frequency resolution of STFT.
                   (given by nti_wavelet_main.pro)
   stft_step:      Length of time steps of STFT.
                   (given by nti_wavelet_main.pro)
   bicoh_avr:      The number of averages of bicoherence.
                   (given by nti_wavelet_main.pro)
   opt:            Color scale optimization factor for plots.

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_plot_stft_bicoh.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_PRIME_FACTOR">
<H2>NTI_WAVELET_PRIME_FACTOR</H2></A>
<A HREF="#NTI_WAVELET_PLOT_STFT_BICOH">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_READ_WAV">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NTI_WAVELET_PRIME_FACTOR

 PURPOSE:
	This function calculate the prime factors of a given number.

 CALLING SEQUENCE:
	result = NTI_WAVELET_PRIME_FACTOR(num)

 INPUTS:
	num:	The integer number which will be splitted into primes.

 EXAMPLE:
	print, NTI_WAVELET_PRIME_FACTOR(234243)
           3           3          17        1531

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_prime_factor.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_READ_WAV">
<H2>NTI_WAVELET_READ_WAV</H2></A>
<A HREF="#NTI_WAVELET_PRIME_FACTOR">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_REMOVE_COLLECTORID">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

NAME: nti_wavelet_read_wav

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2014.05.21.

 PURPOSE: Read wav file and save to sav file that can be read and analysed by NTI Wavelet Tools.

 CALLING SEQUENCE (optional variables marked by []): 
    nti_wavelet_read_wav, filename

 INPUTS:
    filename: File name string of wav file with path

 FILE OUTPUTS:
    .sav file written to same folder as input with same name as input .wav

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_read_wav.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_REMOVE_COLLECTORID">
<H2>NTI_WAVELET_REMOVE_COLLECTORID</H2></A>
<A HREF="#NTI_WAVELET_READ_WAV">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_RIDGE_FOLLOWER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
 NTI_WAVELET_remove_collectorID

 PURPOSE:
 This procedure removes collector id like 'MHA' or 'MHI'
 from channelpairs arrays

 INPUT:
   channel_pairs_id: channelpairs id like ['MHA-B31-14','MHA-B31-12'] 2xn string array

 OUTPUT:
   strArray: corrected array without string before the first '-'
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_remove_collectorid.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_RIDGE_FOLLOWER">
<H2>NTI_WAVELET_RIDGE_FOLLOWER</H2></A>
<A HREF="#NTI_WAVELET_REMOVE_COLLECTORID">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_SIGNUM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
 NTI_WAVELET_RIDGE_FOLLOWER

 PURPOSE:
 This procedure is following ridge in input matrix.

 CALLING SEQUENCE:
 NTI_WAVELET_RIDGE_FOLLOWER, matrix $
 [,xrange_index] [,xaxis] [,xrange_unit] $
 [,start_index_x] [,start_x] $
 [,start_index_y] [,yaxis] [,start_y] $
 [,bandwidth] [,index_bandwidth] $
 [,ridge_treshold] [,ridge_index] [,ridge_unit]

 INPUTS:
 matrix: 2 dimensional matrix which will be investigated
 xrange_index: indices of the investigated range on the x axis,
       a two elements array (optional)
 xaxis:  x axis (optional)
 xrange_unit:  investigated range on the x axis in terms of the unit
       of xaxis, a two elements array (optional)
 start_index_x:  the index of the point on the x axis where the finding
       procedure starts. If this parameter is used, the ridge following
       is performed in each directions (optional)
 start_x:  point on the x axis in terms of the unit of xaxis where the
       finding procedure starts. If this parameter is used, the ridge
       following is performed in each directions (optional)
 start_index_y:  the indices of the range on the y axis where the
       finding procedure starts (optional)
 yaxis:  y axis (optional)
 start_y:  range on the y axis in terms of the unit of yaxis where
       the finding procedure starts (optional)
 bandwidth:  ridge is serached between the twice of this bandwidth
       in terms of the unit of yaxis (optional)
 index_bandwidth:  size of bandwidth in datapoints (optional)
 ridge_treshold: ridge follower stops if amplitude falls below
       the saved peak value times this treshold (optional)
 noise:  ridge follower stops if amplitude falls below 
       the given noise level (optional)

 OUTPUTS:
 ridge_index:  results in indices
 ridge_unit: results in terms of the unit of yaxis

 EXAMPLE:
   restore, './AUGD_23824_Loaded-with-MTR_processed.sav'
   ctrans = *saved_datablock.crosstransforms
   matrix = reform(abs(ctrans(5,*,*)))
   nti_wavelet_ridge_follower, matrix, xaxis = timeax, yaxis = freqax, $
     xrange_unit = [1.28,1.3], start_index_y = [120,130], $
     bandwidth = 5, ridge_index=ridge_index, ridge_unit=ridge_unit

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_ridge_follower.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_SIGNUM">
<H2>NTI_WAVELET_SIGNUM</H2></A>
<A HREF="#NTI_WAVELET_RIDGE_FOLLOWER">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_SINC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
 NTI_WAVELET_SIGNUM

 PURPOSE:
 This function returns the sign of the input data in an array of the same size:
   -1  for negative elements
   1   for positive elements
   0   for 0 and complex number
     only works for numerics

 CALLING SEQUENCE:
 NTI_WAVELET_SIGNUM, input,

 INPUTS:
 input:    scalar,vector, or array

 EXAMPLE:
    a = [[1., -2.], [0., 3.]]
    print, NTI_WAVELET_SIGNUM(a)
     1    -1
     0    1
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_signum.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_SINC">
<H2>NTI_WAVELET_SINC</H2></A>
<A HREF="#NTI_WAVELET_SIGNUM">[Previous Routine]</A>
<A HREF="#NTI_WAVELET_TIMESTAMP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: nti_wavelet_sinc

 Written by: Laszlo Horvath 2010.04.24.

 Purpose: returns the normalized sinc function of an array

 Definition of normalized sinc function:
        y = sin(Pi*x)/(Pi*x)    if x EQ 0
        y = 1                   if x NE 0

 Calling sequence:
 y=nti_wavelet_sinc(x)

 Input:
 x: data array
 
 Output:
 y: sinc of the input array
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_sinc.pro)</STRONG><P>
<HR>
 
<A NAME="NTI_WAVELET_TIMESTAMP">
<H2>NTI_WAVELET_TIMESTAMP</H2></A>
<A HREF="#NTI_WAVELET_SINC">[Previous Routine]</A>
<A HREF="#PG_ANAL2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
 NTI_WAVELET_TIMESTAMP

 PURPOSE:
 This function extracts the timestamp from the name of the plot (standard NTI Wavelet name)
 e.g.: 1469999157957_Toroidal_mode_numbers_of_AUGD_23418 >>> 1469999157957

 CALLING SEQUENCE:
 TIME_ID=NTI_WAVELET_TIMESTAMP(FILE_ID=FILE_ID)

   THIS ROUTINE CALLED BY NTI_WAVELET_GUI.PRO.
   DO NOT CALL THIS ROUTINE ALONE!
   
   INPUT:
   FILE_ID: the full name of the file (returned by pg_filename.pro)
   
   OUTPUT:
   TIME_ID: the timestamp of the file

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\nti_wavelet_time_id.pro)</STRONG><P>
<HR>
 
<A NAME="PG_ANAL2">
<H2>PG_ANAL2</H2></A>
<A HREF="#NTI_WAVELET_TIMESTAMP">[Previous Routine]</A>
<A HREF="#PG_CCORR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: pg_anal2

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2004.10.11.

 Purpose: Calculate band powers

 Calling sequence:
	pg_anal2, matrix, b [,freqax] [,timeax] [,plot] [,/print] [/poster]$
		[,bp=bp] [,/nosum]

 Input:
	matrix: STFT or CWT of 1D data vector
	b: Frequency bands (kHz)
	freqax (optional): Frequency axis
	timeax (optional): Time axis
	plot (optional): Display mode (available: 0: Plot spectrum with band limits
						  3: 0+band powers)
						   ; default: 0
 trange (optional): calculate bandpowers for a given time range
       (tighter then time range of the input matrix) need timeax to function!
 trunc (optional): truncates the signal at both ends at 3*trunc
       (windowsize). call with trange=trange, to give back new trange!

	/print (optional): Produce ps files
	/poster (optional): Print in poster form
	/nosum (optional): Do not calculate spectrum

 Output:
	bp (optional): Band powers
	trange (optional): New trange is returned!
	timeax (optional): New time axis is returtned!

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_anal2.pro)</STRONG><P>
<HR>
 
<A NAME="PG_CCORR">
<H2>PG_CCORR</H2></A>
<A HREF="#PG_ANAL2">[Previous Routine]</A>
<A HREF="#PG_COLORSCALE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_ccorr

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2003.04.08.

 Purpose: Calculate crosscorrelation using FFT

 Calling sequence:
	ccorr=pg_ccorr(data1, data2 [,/fast] [,/dc] [,/nonorm])

 Input:
	data1: 1D data vector
	data2: 1D data vector of the same length
	/fast (optional): Calculate with fast circular convolution
	/dc (optional): without mean subtraction
	/nonorm (optional): Does not norm with ACF(0) - returned
                                                       function is
the covariance function

 Output:
	acorr: Crosscorrelation vector (positive delay shows the delay of data1 with respect to data2)

 Modifications:
	Gergo Pokol 2003.12.16. : Zero padding added to fast convolution
       Gergely Papp 2008.12.16.: Added normalize switch - correct norm
       
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_ccorr.pro)</STRONG><P>
<HR>
 
<A NAME="PG_COLORSCALE">
<H2>PG_COLORSCALE</H2></A>
<A HREF="#PG_CCORR">[Previous Routine]</A>
<A HREF="#PG_CWT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_colorscale

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2003.12.04.

 Purpose: Plot colorscale

 Calling sequence:
	pg_colorscale [,range] [,/print] [,/ct]

 Input:
	range (optional): range of scale
	ct (optional): Color table index (Built-in color tables)
	/print (optional): Produce ps files

 Output: -
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_colorscale.pro)</STRONG><P>
<HR>
 
<A NAME="PG_CWT">
<H2>PG_CWT</H2></A>
<A HREF="#PG_COLORSCALE">[Previous Routine]</A>
<A HREF="#PG_DOWNSAMPLE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME: WV_CWT

 PURPOSE
    This function computes the continuous wavelet transform
    for one-dimensional arrays.

 CALLING SEQUENCE
    Result = WV_CWT( Array, Family, Order)

 INPUTS
   Array = A one-dimensional array of data, either real or complex.

   Family = A string giving the name of the wavelet function to use.

   Order = A scalar specifying the order or parameter
           for the wavelet function.


 OUTPUTS
    Result = A two-dimensional array containing the wavelet transform.
             If Family is symmetric in Fourier space then Result will
             be real (e.g. the 'Gaussian' family). If Family is not
             symmetric then Result will be complex (e.g. 'Morlet' or 'Paul').

 KEYWORD PARAMETERS
   DOUBLE = Set this keyword to force the computation to be done in
        double precision arithmetic.

   DSCALE = Set this keyword to a scalar value giving the spacing
        between scale values, in logarithmic units. The default is 0.25,
        which gives four subscales within each major scale.

   NSCALE = Set this keyword to a scalar value giving the total number
        of scale values to use for the wavelet transform.
        The default is [log 2 (N/START_SCALE)]/DSCALE+1.

   PAD = Set this keyword to force Array to be padded with zeroes before
        computing the transform. Enough zeroes are added to make the
        total length of Array equal to the next-higher power-of-two
        greater than 2N. Padding with zeroes prevents wraparound
        of the Array and speeds up the fast Fourier transform.

      Note - Padding with zeroes reduces, but does not eliminate,
        edge effects caused by the discontinuities at the start
        and end of the data.

   SCALE = Set this keyword to a named variable in which to return
        the scale values used for the continuous wavelet transform.
        The SCALE values range from START_SCALE up to
        START_SCALE*2^[(NSCALE-1)*DSCALE].

   START_SCALE = Set this keyword to a scalar value giving the
        starting scale, in non-dimensional units.
        The default is 2, which gives a starting scale that is
        twice the spacing between Array elements.

 REFERENCE
    Torrence, C. and G.P. Compo, 1998: A practical guide to wavelet analysis.
        Bull. Amer. Meteor. Soc., v. 79, pp. 61-78.

 EXAMPLE
   Morlet wavelet transform using convolution:
      n = 1024
      time = FINDGEN(n)
      data = RANDOMN(seed, n)   ; choose a random time series length n

   Find wavelet transform for Morlet order=6:
      cwt = WV_CWT(data, 'Morlet', 6, SCALE=scale)

   Color contour plot:
      LOADCT, 39
      CONTOUR, cwt, time, scale, /YLOG, /FILL, XSTYLE=1, YSTYLE=1, $
          XTITLE='Time', YTITLE='Scale'

 MODIFICATION HISTORY
    Written by: Chris Torrence, 2000
    CT, RSI, Sept 2001: Complex input was being converted to real.
                        Now uses both real & imaginary parts.

    Gergo Pokol 2003.05.15: Progress indicator added, calls pg_fn_*.pro for wavelets

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_cwt.pro)</STRONG><P>
<HR>
 
<A NAME="PG_DOWNSAMPLE">
<H2>PG_DOWNSAMPLE</H2></A>
<A HREF="#PG_CWT">[Previous Routine]</A>
<A HREF="#PG_FILENAME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_downsample

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2003.04.15.

 Purpose: Perform downsampling on 1D data vector

 Calling sequence:
	y=pg_downsample(x [,step])

 Input:
	x: 1D data vector to be downsampled
	step (optional): scale of downsampling; default: 2

 Output:
	y: Downsampled vector: (y=(x(0),x(step),x(2*step),...)

 Modification:
	2005.04.14: later: (y=(x(step-1),x(2*step-1),...)

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_downsample.pro)</STRONG><P>
<HR>
 
<A NAME="PG_FILENAME">
<H2>PG_FILENAME</H2></A>
<A HREF="#PG_DOWNSAMPLE">[Previous Routine]</A>
<A HREF="#PG_FN_GAUSSIAN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME: pg_filename

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2003.05.29.

 PURPOSE: Create filename from title


 CALLING SEQUENCE:
	filename=pg_filename(title [,ext] [,dir])

 INPUTS:
	title: Title of the plot (string)
	ext (optional): Extension of file; default: '.ps'
	dir (optional): Subdirectory of data; default: 'output'

 OUTPUT:
	filename: Filename of the PS file

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_filename.pro)</STRONG><P>
<HR>
 
<A NAME="PG_FN_GAUSSIAN">
<H2>PG_FN_GAUSSIAN</H2></A>
<A HREF="#PG_FILENAME">[Previous Routine]</A>
<A HREF="#PG_FN_MORLET">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME
    WV_FN_GAUSSIAN

 PURPOSE
    This function returns the Gaussian-derivative wavelet.

 CALLING SEQUENCE
    Info = WV_FN_GAUSSIAN( [Parameter] [, Scale, N]
          [, /DOUBLE] [, /SPATIAL]
          [, WAVELET=Wavelet] )

 INPUTS
    Parameter
        A scalar integer specifying the nondimensional frequency parameter
        for the Gaussian-derivative wavelet. The default is 2 (also known
        as the Marr or Mexican Hat wavelet).

    Scale
        A scalar specifying the normalized wavelet scale of the resulting
        wavelet function.

    N = A scalar specifying either the number of points in the data set
        (for Fourier frequencies) or the width of the wavelet function
        (if /SPATIAL is set).

    Note - if keyword WAVELET is missing then Scale and N are ignored
           and only Info is returned.

 RETURN VALUE:
    Returns a structure with the following information:
          (this is an example for Parameter=6)
       Info = {family:'Gaussian', $    ; name of wavelet family
               order_name:'Derivative', $     ; term used for "order"
               order_range:[1,6,2], $   ; valid range [first,last,default]
               order:2, $                ; order number
               discrete:0, $             ; 0=continuous, 1=discrete
               orthogonal:0, $           ; 0=nonorthogonal, 1=orthogonal
               symmetric:1, $            ; 0=asymmetric, 1=symmetric
               support:-1, $              ; support width
               moments:-1, $              ; # of vanishing moments
               regularity:-1}         ; # of continuous derivatives

 KEYWORD PARAMETERS
    DOUBLE = Set this keyword to force the computation to be done in
        double precision arithmetic.

    WAVELET = Upon return, this keyword will contain a vector of wavelet
        coefficients evaluated either at the spatial coordinates (/SPATIAL), or
        at the Fourier frequencies.

        The spatial coordinates range from -(N-1)/2 to (N-1)/2.
        The Fourier frequencies are in the same order as the FFT,
        and range from:
           [0, 2pi/N, 4pi/N, ..., pi, -pi(N+1)/N, ... -2pi(N-1)/N]

    SPATIAL = Set this keyword to return the wavelet as a function of spatial
        coordinates instead of the default Fourier frequencies.

 REFERENCE
    Torrence, C. and G.P. Compo, 1998: A practical guide to wavelet analysis.
        Bull. Amer. Meteor. Soc., v. 79, pp. 61-78.

 EXAMPLE
   Gaussian-derivative wavelet transform using convolution:
      n = 1024
      x = RANDOMN(seed, n)   ; choose a random time series length n

    parameter 6.0, scale 8, filter width 79 points
      info = WV_FN_GAUSSIAN(6.0, 8, 79, /SPATIAL, WAVELET=wavelet)
    find wavelet transform at scale 8:
      cwtConvol = COMPLEX(CONVOL(x, FLOAT(wavelet), /EDGE_WRAP), $
                    CONVOL(x, IMAGINARY(wavelet), /EDGE_WRAP))

   The same transform using the fast Fourier transform:
      info = WV_FN_GAUSSIAN(6.0, 8, n, WAVELET=wavelet)
      cwtFFT = FFT(FFT(x)*CONJ(wavelet),/INVERSE)

   Note that the FFT method is both much easier (since you don't need
   to choose a filter width) and much faster.

 MODIFICATION HISTORY
    Written by: Chris Torrence, 2000

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_fn_gaussian.pro)</STRONG><P>
<HR>
 
<A NAME="PG_FN_MORLET">
<H2>PG_FN_MORLET</H2></A>
<A HREF="#PG_FN_GAUSSIAN">[Previous Routine]</A>
<A HREF="#PG_FN_PAUL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: PG_FN_MORLET

 PURPOSE
    This function returns the Morlet wavelet.

 CALLING SEQUENCE
    Info = PG_FN_MORLET( [Parameter] [, Scale, N]
          [, /DOUBLE] [, /SPATIAL]
          [, WAVELET=Wavelet] )

 INPUTS
    Parameter
        A scalar specifying the nondimensional frequency parameter
        for the Morlet wavelet. The default is 6.0.

    Scale
        A scalar specifying the normalized wavelet scale of the resulting
        wavelet function.

    N = A scalar specifying either the number of points in the data set
        (for Fourier frequencies) or the width of the wavelet function
        (if /SPATIAL is set).

    Note - if keyword WAVELET is missing then Scale and N are ignored
           and only Info is returned.

 RETURN VALUE:
    Returns a structure with the following information:
          (this is an example for Parameter=6)
       Info = {family:'Morlet', $    ; name of wavelet family
               order_name:'Parameter', $     ; term used for "order"
               order_range:[3,24,6], $   ; valid range [first,last,default]
               order:6, $                ; order number
               discrete:0, $             ; 0=continuous, 1=discrete
               orthogonal:0, $           ; 0=nonorthogonal, 1=orthogonal
               symmetric:1, $            ; 0=asymmetric, 1=symmetric
               support:-1, $              ; support width
               moments:-1, $              ; # of vanishing moments
               regularity:-1}         ; # of continuous derivatives

 KEYWORD PARAMETERS
    DOUBLE = Set this keyword to force the computation to be done in
        double precision arithmetic.

    WAVELET = Upon return, this keyword will contain a vector of wavelet
        coefficients evaluated either at the spatial coordinates (/SPATIAL), or
        at the Fourier frequencies.

        There is a phase and time shift between the spatial and Fourier wavelets!

        The spatial coordinates range from -(N-1)/2 to (N-1)/2.
        The Fourier frequencies are in the same order as the FFT,
        and range from:
           [0, 2pi/N, 4pi/N, ..., pi, -pi(N+1)/N, ... -2pi(N-1)/N]

    SPATIAL = Set this keyword to return the wavelet as a function of spatial
        coordinates instead of the default Fourier frequencies.

 REFERENCE
    Torrence, C. and G.P. Compo, 1998: A practical guide to wavelet analysis.
        Bull. Amer. Meteor. Soc., v. 79, pp. 61-78.

 EXAMPLE
   Morlet wavelet transform using convolution:
      n = 1024
      x = RANDOMN(seed, n)   ; choose a random time series length n

    parameter 6.0, scale 8, filter width 79 points
      info = WV_FN_MORLET(6.0, 8, 79, /SPATIAL, WAVELET=wavelet)
    find wavelet transform at scale 8:
      cwtConvol = COMPLEX(CONVOL(x, FLOAT(wavelet), /EDGE_WRAP), $
                    CONVOL(x, IMAGINARY(wavelet), /EDGE_WRAP))

   The same transform using the fast Fourier transform:
      info = WV_FN_MORLET(6.0, 8, n, WAVELET=wavelet)
      cwtFFT = FFT(FFT(x)*CONJ(wavelet),/INVERSE)

   Note that the FFT method is both much easier (since you don't need
   to choose a filter width) and much faster.

 MODIFICATION HISTORY
    Written by: Chris Torrence, 2000
    Modified by: Gergo Pokol 2003.05.27: Allow parameters (orders) upto 100000
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_fn_morlet.pro)</STRONG><P>
<HR>
 
<A NAME="PG_FN_PAUL">
<H2>PG_FN_PAUL</H2></A>
<A HREF="#PG_FN_MORLET">[Previous Routine]</A>
<A HREF="#PG_GEN_WIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME
    WV_FN_PAUL

 PURPOSE
    This function returns the Paul wavelet.

 CALLING SEQUENCE
    Info = WV_FN_PAUL( [Parameter] [, Scale, N]
          [, /DOUBLE] [, /SPATIAL]
          [, WAVELET=Wavelet] )

 INPUTS
    Parameter
        A scalar integer specifying the nondimensional frequency parameter
        for the Paul wavelet. The default is 4.

    Scale
        A scalar specifying the normalized wavelet scale of the resulting
        wavelet function.

    N = A scalar specifying either the number of points in the data set
        (for Fourier frequencies) or the width of the wavelet function
        (if /SPATIAL is set).

    Note - if keyword WAVELET is missing then Scale and N are ignored
           and only Info is returned.

 RETURN VALUE:
    Returns a structure with the following information:
          (this is an example for Parameter=6)
       Info = {family:'Paul', $    ; name of wavelet family
               order_name:'Parameter', $     ; term used for "order"
               order_range:[1,20,4], $   ; valid range [first,last,default]
               order:4, $                ; order number
               discrete:0, $             ; 0=continuous, 1=discrete
               orthogonal:0, $           ; 0=nonorthogonal, 1=orthogonal
               symmetric:1, $            ; 0=asymmetric, 1=symmetric
               support:-1, $              ; support width
               moments:-1, $              ; # of vanishing moments
               regularity:-1}         ; # of continuous derivatives

 KEYWORD PARAMETERS
    DOUBLE = Set this keyword to force the computation to be done in
        double precision arithmetic.

    WAVELET = Upon return, this keyword will contain a vector of wavelet
        coefficients evaluated either at the spatial coordinates (/SPATIAL), or
        at the Fourier frequencies.

        The spatial coordinates range from -(N-1)/2 to (N-1)/2.
        The Fourier frequencies are in the same order as the FFT,
        and range from:
           [0, 2pi/N, 4pi/N, ..., pi, -pi(N+1)/N, ... -2pi(N-1)/N]

    SPATIAL = Set this keyword to return the wavelet as a function of spatial
        coordinates instead of the default Fourier frequencies.

 REFERENCE
    Torrence, C. and G.P. Compo, 1998: A practical guide to wavelet analysis.
        Bull. Amer. Meteor. Soc., v. 79, pp. 61-78.

 EXAMPLE
   Paul wavelet transform using convolution:
      n = 1024
      x = RANDOMN(seed, n)   ; choose a random time series length n

    parameter 6.0, scale 8, filter width 79 points
      info = WV_FN_PAUL(6.0, 8, 79, /SPATIAL, WAVELET=wavelet)
    find wavelet transform at scale 8:
      cwtConvol = COMPLEX(CONVOL(x, FLOAT(wavelet), /EDGE_WRAP), $
                    CONVOL(x, IMAGINARY(wavelet), /EDGE_WRAP))

   The same transform using the fast Fourier transform:
      info = WV_FN_PAUL(6.0, 8, n, WAVELET=wavelet)
      cwtFFT = FFT(FFT(x)*CONJ(wavelet),/INVERSE)

   Note that the FFT method is both much easier (since you don't need
   to choose a filter width) and much faster.

 MODIFICATION HISTORY
    Written by: Chris Torrence, 2000

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_fn_paul.pro)</STRONG><P>
<HR>
 
<A NAME="PG_GEN_WIN">
<H2>PG_GEN_WIN</H2></A>
<A HREF="#PG_FN_PAUL">[Previous Routine]</A>
<A HREF="#PG_INITGRAPH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_gen_win

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2002.07.15.
 Rewritten by: Gergo Pokol (pokol@reak.bme.hu) 2003.03.24

 Purpose: Return window of specified shape and length and unit norm.

 Calling sequence:
	win = pg_gen_win( windowsize [,masksize] [,windowname] [,/plot] [,/print] [,/double] )

 Inputs:
	windowsize: length of window (standard deviation *2 for Gauss window)
	masksize (optional): length of mask vector for infinit support windows; default: all nonzero values
	windowname (optional): shape of the window (available: 'Gauss','Rectangle','Hanning','Hamming','Burst'); default: 'Gauss'
	/double (optional): double precision
	/plot (optional): Plot window

 Output:
	win: 1D vector of non-zero coefficients of the uniformly sampled window function

 Modified:
	Gergo Pokol 2003.12.16. : Correct masksize for Gauss window
	Gergo Pokol 2004.02.11. : Modify to L2 norm
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_gen_win.pro)</STRONG><P>
<HR>
 
<A NAME="PG_INITGRAPH">
<H2>PG_INITGRAPH</H2></A>
<A HREF="#PG_GEN_WIN">[Previous Routine]</A>
<A HREF="#PG_LOG2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: pg_initgraph

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2003.04.15.

 PURPOSE: Initialize graphics

 CALLING SEQUENCE:
	pg_initgraph [,/print] [,/portrait]

 INPUTS:
	/print (optional): Print to file instead of plotting
	/portrait (optional): Portrait ps file

 OUTPUT: -

 EXAMPLE:
   pg_initgraph, /print
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_initgraph.pro)</STRONG><P>
<HR>
 
<A NAME="PG_LOG2">
<H2>PG_LOG2</H2></A>
<A HREF="#PG_INITGRAPH">[Previous Routine]</A>
<A HREF="#PG_MODEFILTER_FITREL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_log2

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2003.04.17.

 Purpose: Return log base 2 of a number

 Calling sequence:
	y=pg_log2(x)

 Input: 
	x: number

 Output: 
	y: log base 2 of x

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_log2.pro)</STRONG><P>
<HR>
 
<A NAME="PG_MODEFILTER_FITREL">
<H2>PG_MODEFILTER_FITREL</H2></A>
<A HREF="#PG_LOG2">[Previous Routine]</A>
<A HREF="#PG_MODEFILTER_MONOTON">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: pg_modefilter_fitrel

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2007.04.20.

 PURPOSE: Select most fitting linear to the relative phases as a function of their relative position
				(Can be used for a set of probes limited to a segment of the cross section)

 CALLING SEQUENCE:
	modenum=pg_modefilter_fitrel(cphases, chpos [,weights] [,moderange] [,modestep] [,qlim]$
		[,ms=ms][,qs=qs][,chi2=chi2])

 INPUTS:
		cphases: relative cross-phases in radians
		chpos: channel positions in radians 
    If chpos is a 1D vector, a combination of all probes is implied, while a 2D chpos matrix implies 
      pre/selected channel pairs. 
		weigths (optional): weights of the fit; default: ones; For chi2 probe 1/sigma^2 is to be given.
		moderange (optional): vector of minimum and maximum modenumbers to be considered
			default:[-channelssize,channelssize]
		modestep (optional): modenumber steps to be considered; default: 1
		qlim (optional): minimum distance accepted Q values from Q_mean measuredin Q_stddev units
			default: 0 (everything is accepted)

 OUTPUT:
		modenum: modenumber, or 1000 for not defined modenumber
		ms (optional): mode number vector
		qs (optional): Q_m vector (with normalized weights)
   chi2 (optional): chi2 value of each fit
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_modefilter_fitrel.pro)</STRONG><P>
<HR>
 
<A NAME="PG_MODEFILTER_MONOTON">
<H2>PG_MODEFILTER_MONOTON</H2></A>
<A HREF="#PG_MODEFILTER_FITREL">[Previous Routine]</A>
<A HREF="#PG_NUM2STR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_modefilter_monoton

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2007.02.26.-03.01.

 Purpose: Filter modenumbers from pre-calculated cross-phases assuming monoton (with a given margin)
				 change of phases and equal modenumbers with all reference probes, selects smaller modenumber

 Inputs:
		cphases: relative cross-phases in radians
   chpos: 1D vector of channel positions in radians.
		marginfraction (optional): fraction of default margin of monotonization; default:1
   moderange (optional): vector of minimum and maximum modenumbers to be considered
     default:[-999,999] (unlimited)

 Output:
		modenum: modenumber, or 1000 for not defined modenumber
   ms (optional): mode number vector [positive, negative]
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_modefilter_monoton.pro)</STRONG><P>
<HR>
 
<A NAME="PG_NUM2STR">
<H2>PG_NUM2STR</H2></A>
<A HREF="#PG_MODEFILTER_MONOTON">[Previous Routine]</A>
<A HREF="#PG_OTV">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_num2str

 Written by: Gergo Pokol (pokol@rmki.kfki.hu) 2003.03.24.

 Purpose: Convert a number to a string of minimum or specified length

 Calling sequence:
	str = pg_num2str(num [,length])

 Inputs:
	num: Number
	length (optional): Length of the resulting string

 Output:
	str: string

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_num2str.pro)</STRONG><P>
<HR>
 
<A NAME="PG_OTV">
<H2>PG_OTV</H2></A>
<A HREF="#PG_NUM2STR">[Previous Routine]</A>
<A HREF="#PG_PHASEDIAGRAM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_otv

 Written by: Sandor Zoletnik ?
 Rewritten by: Gergo Pokol (pokol@reak.bme.hu) 2007.02.23.

 Purpose: Plot array as bitmap (after shrinking with cubic reasmpling)

 Calling sequence:
	pg_otv,q [,/original] [,/nearest]

 Inputs:
		q: Array to be plotted
		/original (optional): Plot original size
		/nearest (optional): Use nearest neibourghood resampling
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_otv.pro)</STRONG><P>
<HR>
 
<A NAME="PG_PHASEDIAGRAM">
<H2>PG_PHASEDIAGRAM</H2></A>
<A HREF="#PG_OTV">[Previous Routine]</A>
<A HREF="#PG_PLOT4">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: pg_phasediagram

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2007.03.09.

 PURPOSE: Plot phasediagrams derived from time-frequency cross-transforms at given time and frequency coordinates

 CALLING SEQUENCE:
	pg_phasediagram, cphases, chpos, timeax, freqax, time, freq [,shot] [,channels] [,filters] [,/print]$
		 [,filterparam1] [,filterparam2] [,cpows=cpows] [,cohs=cohs] [,cphaserr=cphaserr]

 INPUTS:
		cphases: Cross-phases
		chpos: channel positions in degrees; default: W7-AS Mirnov/MIR-1 coils
		timeax: Time axis
		freqax: Frequency axis
		time: Time of phase diagram
		freq: Frequency of phase diagram
		shot (optional): shot number
		channels (optional): channel numbers; default: W7-AS Mirnov/MIR-1 coils
		cpows (optional): Cross-powers
		cohs (optional): Coherences
   cphaserr (optional): Cross-phases error (only with filter 11 & 12)
		filters (optional): vector of filter numbers to use; default: [0] available filters:
			0: Simple plot with all reference channels
			1: Plot phase diagrams with all reference signals assuming monotone increase
			2: Plot phase diagrams with all reference signals assuming monotone decrease
			3: Plot phase diagrams with all reference signals assuming monotone increase and linear fit to mean
			4: Plot phase diagrams with all reference signals assuming monotone decrease and linear fit to mean
			5: Plot phase diagrams with all reference signals assuming increase and optimizing to linear fit to mean
			6: Plot phase diagrams with all reference signals assuming decrease and optimizing to linear fit to mean
			7: Plot relative phases as a function of their relative position
			8: Plot relative phases as a function of their relative position and most fitting linear
					+ residuum as function of modenumber
				filterparam1 (optional): modenumber steps to be considered; default:1
				filterparam2 (optional): modenumber range to be considered; default:[-channelssize,channelssize]
			9: Plot relative phases as a function of their relative position and most fitting linear with
					weight=coherence/median(coherence) + residuum as function of modenumber
				filterparam1 (optional): modenumber steps to be considered; default:1
				filterparam2 (optional): modenumber range to be considered; default:[-channelssize,channelssize]
    10: Plot relative phases as a function of their relative postion in the interval [0,pi]
         + residuum as function of modenumber
       filterparam1 (optional): modenumber steps to be considered; default:1
       filterparam2 (optional): modenumber range to be considered; default:[-channelssize,channelssize]
    11: Plot relative phases with errorbars as a function of their relative position
         + residuum as function of modenumber
       filterparam1 (optional): modenumber steps to be considered; default:1
       filterparam2 (optional): modenumber range to be considered; default:[-channelssize,channelssize]
    12: Plot relative phases with errorbars as a function of their relative position
        and the most fitting linear with weights calculated from phase-errors
        + residuum as function of modenumber
        + chi-square test result as function of modenumber
       filterparam1 (optional): modenumber steps to be considered; default:1
       filterparam2 (optional): modenumber range to be considered; default:[-channelssize,channelssize]
		/print (optional): Print to file instead of plotting

 OUTPUT: -

 EXAMPLE:
    restore, 'data/AUG_SXR_F17_G17_modenumbers_22036_2220_ord_12_avr_5_mode_6_Q_1_5_10_20.sav'
    pg_phasediagram,cphases, chpos, timeax, freqax, 2.26, 8, shot=22036, channels=channels, filters=[8],$
      filterparam2=[-6,6], /print, cpows=cpows, cohs=cohs

 MODIFICATION HISTORY:
		2007.04.11. Gergo Pokol: filters 3,4 added
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_phasediagram.pro)</STRONG><P>
<HR>
 
<A NAME="PG_PLOT4">
<H2>PG_PLOT4</H2></A>
<A HREF="#PG_PHASEDIAGRAM">[Previous Routine]</A>
<A HREF="#PG_REMOVESTR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME: pg_plot4

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2004.12.07.

 PURPOSE: Visualize a 2D matrix

 CALLING SEQUENCE:
	pg_plot4, matrix [,ct] [,xrange] [,yrange] [,y2range] [,zrange] [,/intz] [,data] [,xtitle] [,ytitle] $
		[,y2title] [,title] [,cscale_axis_title] [,opt] [,/ylog] [,/zlog] [,/original] [,/nearest] [,/poster]

 INPUTS:
	matrix: 2D matrix to be visualized
	ct (optional): Color table index (Built-in color tables)
	xrange (optional): Range of x axis; default: matrix x-dimension
	yrange (optional): Range of y axis; default: matrix y-dimension
	y2range (optional): Range of 2nd y axis; default: no 2nd axis
	zrange (optional): Range of colorscale; default: matrix value range
	data (optional): Extra data to be written on graph
	ridge (optional): Plot ridge (1D vector) on graph
	xtitle (optional): Title of x axis
	ytitle (optional): Title of y axis
	y2title (optional): Title of 2nd y axis
	title (optional): Title of the plot
 cscale_axis_title: (optional): Axis-title of the colorscale
	opt (optional): Exponent for opimized scale visualization
	/ylog (optional): Logarithmic 1st y axis
	/zlog (optional): Logarithmic color scale
	/intz (optional): Plot discrete colorscale at integer values (and skip color code 255)
	/original (optonal): Do not resize matrix
	/nearest (optional): Use nearest neibourghood resampling
	/poster (optional): Print in poster form

 OUTPUT: -

 MODIFICATION HISTORY:
   Automatic resize of matrix in pg_otv (Gergo Pokol, 2007.02.23)
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_plot4.pro)</STRONG><P>
<HR>
 
<A NAME="PG_REMOVESTR">
<H2>PG_REMOVESTR</H2></A>
<A HREF="#PG_PLOT4">[Previous Routine]</A>
<A HREF="#PG_RESAMPLE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_removestr

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2003.05.28.

 Purpose: Replace special characters from string

 Calling sequence:
	str2=pg_removestr(str1)

 Input: 
	str1: string

 Output: 
	str2: string
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_removestr.pro)</STRONG><P>
<HR>
 
<A NAME="PG_RESAMPLE">
<H2>PG_RESAMPLE</H2></A>
<A HREF="#PG_REMOVESTR">[Previous Routine]</A>
<A HREF="#PG_RETRIGGER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_resample

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2004.09.23.

 Purpose: Fast resampling using Shannon, Whittaker sampling theorem

 Calling sequence:
	xx=pg_resample(x, ttsize)

 Input:
	x: data vector
	ttsize: resampled size

 Output:
	xx: resampled data vector

 Switches:
 time_domain: resampling in time domain (it takes up a lot of time, because
              the double for loop)
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_resample.pro)</STRONG><P>
<HR>
 
<A NAME="PG_RETRIGGER">
<H2>PG_RETRIGGER</H2></A>
<A HREF="#PG_RESAMPLE">[Previous Routine]</A>
<A HREF="#PG_SCALOGRAM_SIM2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_retrigger

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2004.09.30.

 Purpose: Shift signal in time with a fraction of the sample time

 Calling sequence:
	xx=pg_retrigger(x, fraction)

 Input:
	x: data vector
	fraction: time2=time1-fraction*sampletime

 Output:
	xx: timeshifted data vector

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_retrigger.pro)</STRONG><P>
<HR>
 
<A NAME="PG_SCALOGRAM_SIM2">
<H2>PG_SCALOGRAM_SIM2</H2></A>
<A HREF="#PG_RETRIGGER">[Previous Routine]</A>
<A HREF="#PG_SPECTROGRAM_SIM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: pg_scalogram_sim2

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2003.06.14.

 PURPOSE: Plot the Scalogram or the Phase of the Continous Wavelet Transform of a 1D data vector

 CALLING SEQUENCE:
	cwt=pg_scalogram_sim2(data, time [,shot] [,channel] [,trange] [,family] [,order] [,dscale] [,start_scale] [,nscale]  $
		[,plot] [,/print] [,/poster] [,/pad] [,/log] [,opt] [,/double] [,freqax=freqax] [,scaleax=scaleax])

 INPUTS:
	data: signal
	timeax: time axis
	shot (optional): shot number
	channel (optional): channel number
	trange (optional): timerange to view, 2 element vector; default: whole range
	fmax (optional): frequency maximum of spectrogram (in kHz), resampled with pg_resample, Downsamples time axis!
	family (optional): wavelet family to use (available: 'Morlet'); default: 'Morlet'
	order (optional): order of the wavelet; default: default of the family
	dscale (optional): fraction of diadic scaling; default:0.25
	start_scale (optional): starting scale (has no effect on CWT using Morlet wavelets; default:2
	nscale (optional): total number of scale values; default:log2(N/start_scale)/dscale+1
	plot (optional): display mode (available: 0:All, 1:Scalogram(log), 2:Phase,
					3:Scalogram(lin+log) (for Morlet wavelets only), 
         4:Scalogram(lin with forced 0 freq. scale + log) (for Morlet wavelets only),
         other:None; default: 0
	opt (optional): exponent for opimized scale visualization
	/print (optional): Print to file instead of plotting
	/poster (optional): Print in poster form
	/pad (optional): use zero padding instead of cutting the data vector to 2^x length
	/log (optional): visualize on log scale (except for Phase)
	/double (optional): double precision

 OUTPUT:
	cwt: CWT of signal
	freqax (optional): frequency axis
	scaleax (optional): scale axis

 EXAMPLE:

 MODIFICATION HISTORY:
  Gergo Pokol (pokol@reak.bme.hu) 2004.12.08. (frequency axis added)
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_scalogram_sim2.pro)</STRONG><P>
<HR>
 
<A NAME="PG_SPECTROGRAM_SIM">
<H2>PG_SPECTROGRAM_SIM</H2></A>
<A HREF="#PG_SCALOGRAM_SIM2">[Previous Routine]</A>
<A HREF="#PG_STFT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: pg_spectrogram_sim

 Written by: Gergo Pokol (pokol@reak.bme.hu) 2003.06.12.

 PURPOSE: Plot the Spectrogram or the Phase of the Short Time Fourier Transform of a signal

 CALLING SEQUENCE:
	stft=pg_spectrogram_sim( data, timeax [,shot] [,channel] [,trange] [,fmax] [,windowname] [,windowsize] [,masksize] [,step] $
		[,freqres] [,plot] [,/print] [,/poster] [,/dc] [,/log] [,opt] [,/double] [,/error] [,errdata=errdata] [,abs_err=abs_err] $
		[,phase_err=phase_err] [,freqax=freqax] )

 INPUTS:
	data: signal
	timeax: time axis
	shot (optional): shot number
	channel (optional): channel number
	trange (optional): timerange to view, 2 element vector; default: whole range
	fmax (optional): frequency maximum of spectrogram (in kHz), resampled with pg_resample, Downsamples time axis!
	windowsize (optional): length of window (standard deviation *2 for Gauss window); default: length of data / 10
	masksize (optional): length of mask vector; default: all nonzero values
	windowname (optional): shape of the window (available: see in pg_gen_win.pro)
	step (optional): time steps of FFT; default: 1
	freqres (optional): frequency resolution, it must be an odd number,
     even number leads to incorrect frequency axis; default: length of data
	plot (optional): display mode (available: 0:All, 1:Spectrogram, 2:Phase, other:None); default: 1
	opt (optional): exponent for opimized scale visualization
	errdata (optional): error on the input signal
	/print (optional): Print to file instead of plotting
	/poster (optional): Print in poster form
	/dc (optional): without mean subtraction
	/log (optional): visualize on log scale (except for Phase)
	/double (optional): double precision
	/error (optional): calculate error on stft

 OUTPUT:
	stft: STFT of signal
	freqax (optional): Frequency scale
	abs_err (optional): error on the absolute value of the STFT
	phase_err (optional): error on the phase of the STFT

 EXAMPLE:

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_spectrogram_sim.pro)</STRONG><P>
<HR>
 
<A NAME="PG_STFT">
<H2>PG_STFT</H2></A>
<A HREF="#PG_SPECTROGRAM_SIM">[Previous Routine]</A>
<A HREF="#PI_LOADNCOL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: pg_stft

 Written by: Gergo Pokol (lokop@uze.net) 2002.07.15.

 Purpose: Return the Short Time Fourier Transform of a 1D data vector with zero padding

 Calling sequence:
	stft = pg_stft( data [,errdata] [,windowsize] [,masksize] [,windowname] [,step] [,freqres] [,/dc] [,/double] $
		[,/error] [,abs_err=abs_err] [,phase_err=phase_err])

 Inputs:
	data: 1D vector of data
	windowsize (optional): length of window (standard deviation *2 for Gauss window); default: length of data / 10
	masksize (optional): length of mask vector for infinite support windows; default: all nonzero values
	windowname (optional): shape of the window (available: see in pg_gen_win.pro)
	step (optional): time steps of FFT; default: 1
	freqres (optional): frequency resolution (*2); default: length of data
	errdata (optional): error on the input signal
	/dc (optional): without mean subtraction
	/double (optional): double precision
	/error (optional): calculate error on stft

 Output:
	stft: nxn matrix of the Short Time Fourier Transform of the input data
	abs_err (optional): error on the absolute value of the STFT
	phase_err (optional): error on the phase of the STFT

 Modification:
	Gergo Pokol 2002.07.17: Introduction of step variable
	Gergo Pokol 2003.03.25: Changes in the use of pg_gen_win
	Gergo Pokol 2003.03.27: Repares to allow odd length windows
	Gergo Pokol 2003.04.08: Optional mean subtraction added
	Gergo Pokol 2003.04.15: Frequency resolution added
	Gergo Pokol 2004.02.11: FFT norming factor added

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_stft.pro)</STRONG><P>
<HR>
 
<A NAME="PI_LOADNCOL">
<H2>PI_LOADNCOL</H2></A>
<A HREF="#PG_STFT">[Previous Routine]</A>
<A HREF="#START_WEB_BROWSER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

NAME: pi_loadancol

 ************************** LOADNCOL.PRO *************** 28.07.2000 ******************
                                                 Written by S. Zoletnik
   Modified by Istvan Pusztai; 19.07.2007
   Modified by Gergo Pokol; 21.07.2008, stringout switch added
 This function reads numbers (or strings) arranged in rows and columns from and ASCII file.
 This program replaces and old version which used unix systems calls to determine
 the number of lines and columns. The present version uses only IDL file operations
 this it shoudl be system-independent.
   Each line should contain exactly the same amount of numbers (or strings). A file header can be
 handled if the headerline argument gives the number of header lines.
   The return value is a 2D array of float numbers (or strings), first index is line number, second
 is column. In case of error, 0 is returned.

 INPUT:
   file: name of file (string)
   n: number of columns (optional, if not given will be determined from first non-header
      line
   headerline: number of header lines
   text: The header text is returned in this variable (string array)
   /cutzero: omit trailing lines with all zeros
 /silent: DO not print info and error messages
   errormess: error message or ''  (string)
   tmpfile: not used, kept for compatibility with all loadncol
 block_line_n:
 /stringout: Return string array, no conversion to floating point
 ***************************************************************************************
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pi_loadncol.pro)</STRONG><P>
<HR>
 
<A NAME="START_WEB_BROWSER">
<H2>START_WEB_BROWSER</H2></A>
<A HREF="#PI_LOADNCOL">[Previous Routine]</A>
<A HREF="#WV_FN_COIFLET">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	START_WEB_BROWSER

 PURPOSE:
	This procedure starts the input website in a web browser.

 CALLING SEQUENCE:
	START_WEB_BROWSER, site

 INPUTS:
	site:	This is the website, which will be started.

 EXAMPLE:
	START_WEB_BROWSER, 'www.reak.bme.hu'

</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\start_web_browser.pro)</STRONG><P>
<HR>
 
<A NAME="WV_FN_COIFLET">
<H2>WV_FN_COIFLET</H2></A>
<A HREF="#START_WEB_BROWSER">[Previous Routine]</A>
<A HREF="#WV_FN_DAUBECHIES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
    WV_FN_COIFLET

 PURPOSE:
    This function returns the Coiflet wavelet coefficients.

 CALLING SEQUENCE:
    info = WV_FN_COIFLET( Order, Scaling, Wavelet, Ioff, Joff)

 INPUTS:
    Order: This is the order number for the Coiflet wavelet.
           Order=1 is the "Daubechies Coiflet L=2" wavelet,
           and has 2 vanishing moments and 6 coefficients.

 OUTPUTS:
    Scaling: A vector of the scaling (father) coefficients

    Wavelet: A vector of the wavelet (mother) coefficients

    Ioff: The offset index used to center the Scaling support

    Joff: The offset index used to center the Wavelet support

 KEYWORD PARAMETERS:
    None.

 RETURN VALUE:
    Returns a structure with the following information:
          (this is an example for order=1)
       info = {family:'Coiflet', $    ; name of wavelet family
               order_name:'Order', $     ; term used for "order"
               order_range:[1,5,1], $    ; valid range [first,last,default]
               order:1, $                ; order number
               discrete:1, $             ; 0=continuous, 1=discrete
               orthogonal:1, $           ; 0=nonorthogonal, 1=orthogonal
               symmetric:2, $            ; 0=asymmetric, 1=sym., 2=near sym.
               support:5, $              ; support width
               moments:2, $              ; # of vanishing moments
               regularity:0.550}         ; # of continuous derivatives

 REFERENCE:
    Daubechies, I., 1992: Ten Lectures on Wavelets, SIAM, p. 261.
       Note that Daubechies has divided by Sqrt(2), and the coefficients
       are reversed.

    Actual coefficients from <http://www.isds.duke.edu/~brani/filters.html>

 MODIFICATION HISTORY:
    Written by: Chris Torrence, 1999
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_fn_coiflet.pro)</STRONG><P>
<HR>
 
<A NAME="WV_FN_DAUBECHIES">
<H2>WV_FN_DAUBECHIES</H2></A>
<A HREF="#WV_FN_COIFLET">[Previous Routine]</A>
<A HREF="#WV_FN_HAAR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
    WV_FN_DAUBECHIES

 PURPOSE:
    This function returns the Daubechies wavelet coefficients.

 CALLING SEQUENCE:
    info = WV_FN_DAUBECHIES( Order, Scaling, Wavelet, Ioff, Joff)

 INPUTS:
    Order: This is the order number for the Daubechies wavelet.
           Order=2 is the "db2" wavelet, and has 2 vanishing moments
           and 4 coefficients.

 OUTPUTS:
    Scaling: A vector of the scaling (father) coefficients

    Wavelet: A vector of the wavelet (mother) coefficients

    Ioff: The offset index used to center the Scaling support

    Joff: The offset index used to center the Wavelet support

 KEYWORD PARAMETERS:
    None.

 RETURN VALUE:
    Returns a structure with the following information:
          (this is an example for order=2)
       info = {family:'Daubechies', $    ; name of wavelet family
               order_name:'Order', $     ; term used for "order"
               order_range:[2,24,2], $   ; valid range [first,last,default]
               order:2, $                ; order number
               discrete:1, $             ; 0=continuous, 1=discrete
               orthogonal:1, $           ; 0=nonorthogonal, 1=orthogonal
               symmetric:0, $            ; 0=asymmetric, 1=symmetric
               support:3, $              ; support width
               moments:2, $              ; # of vanishing moments
               regularity:0.550}         ; # of continuous derivatives

 REFERENCE:
    Daubechies, I., 1992: Ten Lectures on Wavelets, SIAM, p. 195.
       Daubechies has orders 2-10, although note that Daubechies
       has multiplied by Sqrt(2).

    Orders 11-24 are from <http://www.isds.duke.edu/~brani/filters.html>

 MODIFICATION HISTORY:
    Written by: Chris Torrence, 1999
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_fn_daubechies.pro)</STRONG><P>
<HR>
 
<A NAME="WV_FN_HAAR">
<H2>WV_FN_HAAR</H2></A>
<A HREF="#WV_FN_DAUBECHIES">[Previous Routine]</A>
<A HREF="#WV_FN_SYMLET">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
    WV_FN_HAAR

 PURPOSE:
    This function returns the Haar wavelet coefficients.

 CALLING SEQUENCE:
    info = WV_FN_HAAR(Order, Scaling, Wavelet, Ioff, Joff)

 INPUTS:
    Order: This is the order number for the Haar wavelet.
           It is automatically set to 1 (equivalent to Daubechies order=1),
           regardless of the input.

 OUTPUTS:
    Scaling: The scaling (father) coefficients [1d,1d]/SQRT(2d)

    Wavelet: The wavelet (mother) coefficients [1d,-1d]/SQRT(2d)

    Ioff: The offset index used to center the Scaling support (Ioff=0)

    Joff: The offset index used to center the Wavelet support (Joff=0)

 KEYWORD PARAMETERS:
    None.

 RETURN VALUE:
    Returns a structure with the following information:
       info = {family:'Haar', $    ; name of wavelet family
               order:1, $                ; order number
               order_name:'Order', $     ; term used for "order"
               order_range:[1], $        ; valid range for orders
               discrete:1, $             ; 0=continuous, 1=discrete
               orthogonal:1, $           ; 0=nonorthogonal, 1=orthogonal
               symmetric:0, $            ; 0=asymmetric, 1=symmetric
               support:1, $              ; support width
               moments:1, $              ; # of vanishing moments
               regularity:0.0}           ; # of continuous derivatives

 MODIFICATION HISTORY:
    Written by: Chris Torrence, 1999
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_fn_haar.pro)</STRONG><P>
<HR>
 
<A NAME="WV_FN_SYMLET">
<H2>WV_FN_SYMLET</H2></A>
<A HREF="#WV_FN_HAAR">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
    WV_FN_SYMLET

 PURPOSE:
    This function returns the Symlet wavelet coefficients.

 CALLING SEQUENCE:
    info = WV_FN_SYMLET( Order, Scaling, Wavelet, Ioff, Joff)

 INPUTS:
    Order: This is the order number for the Symlet wavelet.
           Order=4 has 4 vanishing moments and 8 coefficients.

 OUTPUTS:
    Scaling: A vector of the scaling (father) coefficients

    Wavelet: A vector of the wavelet (mother) coefficients

    Ioff: The offset index used to center the Scaling support

    Joff: The offset index used to center the Wavelet support

 KEYWORD PARAMETERS:
    None.

 RETURN VALUE:
    Returns a structure with the following information:
          (this is an example for order=2)
       info = {family:'Symlet', $    ; name of wavelet family
               order_name:'Order', $     ; term used for "order"
               order_range:[4,15,4], $   ; valid range [first,last,default]
               order:4, $                ; order number
               discrete:1, $             ; 0=continuous, 1=discrete
               orthogonal:1, $           ; 0=nonorthogonal, 1=orthogonal
               symmetric:2, $            ; 0=asymmetric, 1=sym., 2=near sym.
               support:7, $              ; support width
               moments:4, $              ; # of vanishing moments
               regularity:0.550}         ; # of continuous derivatives

 REFERENCE:
    Daubechies, I., 1992: Ten Lectures on Wavelets, SIAM, p. 198.
       Daubechies has orders 4-10, although note that Daubechies
       has multiplied by Sqrt(2), and for some Orders the coefficients
       are reversed.

    Orders 11-15 are from <http://www.isds.duke.edu/~brani/filters.html>

 MODIFICATION HISTORY:
    Written by: Chris Torrence, 1999
</PRE><P>
<STRONG>(See A:\3programs\NTI_Wavelet_Tools\branches\AUG_NTI_Wavelet_Tools_released\pg_fn_symlet.pro)</STRONG><P>
<HR>
 
</body>
</html>
